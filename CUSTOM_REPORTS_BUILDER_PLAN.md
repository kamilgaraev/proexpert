# ÐŸÐ»Ð°Ð½ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€Ð° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²

## ðŸ“Š ÐžÐ±Ð·Ð¾Ñ€

ÐšÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² - Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¼Ð¾Ð´ÑƒÐ»Ñ `advanced-reports`, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‰Ð°Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ Ñ Ð³Ð¸Ð±ÐºÐ¾Ð¹ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¾Ð¹ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð², Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¹ Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸.

**ÐœÐ¾Ð´ÑƒÐ»ÑŒ:** `advanced-reports`  
**Permission:** `advanced_reports.custom_reports`  
**Ð¢Ð¸Ð¿:** Feature (Ð¿Ð»Ð°Ñ‚Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ)

---

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹

1. **ÐœÐ¾Ð´ÐµÐ»Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…** - CustomReport, CustomReportExecution, CustomReportSchedule
2. **Ð¡ÐµÑ€Ð²Ð¸ÑÑ‹ Ð±Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÐ¸** - Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð², Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ, Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
3. **API ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ñ‹** - CRUD Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð², ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼
4. **Ð ÐµÐ³Ð¸ÑÑ‚Ñ€ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…** - Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ñ‚Ð°Ð±Ð»Ð¸Ñ† Ð¸ Ð¿Ð¾Ð»ÐµÐ¹
5. **Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸** - Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°, Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ SQL-Ð¸Ð½ÑŠÐµÐºÑ†Ð¸Ð¹

---

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð°: `custom_reports`

Ð¥Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```sql
- id (bigint, PK)
- name (string) - Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
- description (text, nullable) - Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
- organization_id (FK) - Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ
- user_id (FK) - ÑÐ¾Ð·Ð´Ð°Ñ‚ÐµÐ»ÑŒ
- report_category (string) - ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: finances, materials, works, projects, staff
- data_sources (json) - Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¸Ñ… ÑÐ²ÑÐ·Ð¸
  {
    "primary": "projects",
    "joins": [
      {"table": "contracts", "type": "left", "on": ["projects.id", "contracts.project_id"]},
      {"table": "organizations", "type": "inner", "on": ["projects.organization_id", "organizations.id"]}
    ]
  }
- query_config (json) - ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
  {
    "where": [
      {"field": "projects.status", "operator": "=", "value": "active"},
      {"field": "projects.created_at", "operator": ">=", "value": "2024-01-01"}
    ],
    "where_logic": "and"
  }
- columns_config (json) - ÐºÐ¾Ð»Ð¾Ð½ÐºÐ¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
  [
    {
      "field": "projects.name",
      "label": "ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",
      "order": 1,
      "format": "text",
      "width": 200
    },
    {
      "field": "projects.budget_amount",
      "label": "Ð‘ÑŽÐ´Ð¶ÐµÑ‚",
      "order": 2,
      "format": "currency",
      "aggregation": "sum"
    }
  ]
- filters_config (json) - Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  [
    {
      "field": "projects.status",
      "label": "Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",
      "type": "select",
      "options": ["active", "completed", "on_hold"],
      "required": false,
      "default": null
    },
    {
      "field": "projects.start_date",
      "label": "Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°",
      "type": "date_range",
      "required": true
    }
  ]
- aggregations_config (json) - Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¸ Ð¸ Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ¸
  {
    "group_by": ["projects.status"],
    "aggregations": [
      {"field": "projects.budget_amount", "function": "sum", "alias": "total_budget"},
      {"field": "projects.id", "function": "count", "alias": "projects_count"}
    ],
    "having": [
      {"field": "total_budget", "operator": ">", "value": 100000}
    ]
  }
- sorting_config (json) - ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°
  [
    {"field": "projects.created_at", "direction": "desc"},
    {"field": "projects.name", "direction": "asc"}
  ]
- visualization_config (json, nullable) - Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð²
  {
    "enabled": true,
    "chart_type": "bar",
    "x_axis": "projects.name",
    "y_axis": "total_budget",
    "colors": ["#3b82f6", "#10b981"]
  }
- is_shared (boolean) - Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð²ÑÐµÐ¹ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- is_favorite (boolean) - Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð´Ð»Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
- is_scheduled (boolean) - Ð¸Ð¼ÐµÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
- execution_count (integer) - ÑÑ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹
- last_executed_at (timestamp, nullable)
- created_at, updated_at, deleted_at
```

**Ð˜Ð½Ð´ÐµÐºÑÑ‹:**
- `(organization_id, is_shared, deleted_at)`
- `(user_id, deleted_at)`
- `(report_category)`

---

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð°: `custom_report_executions`

Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```sql
- id (bigint, PK)
- custom_report_id (FK) - Ð¾Ñ‚Ñ‡ÐµÑ‚
- user_id (FK) - ÐºÑ‚Ð¾ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð»
- organization_id (FK)
- applied_filters (json) - Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹
  {
    "projects.status": "active",
    "projects.start_date": {"from": "2024-01-01", "to": "2024-12-31"}
  }
- execution_time_ms (integer) - Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð² Ð¼Ñ
- result_rows_count (integer) - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÑ‚Ñ€Ð¾Ðº Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
- export_format (string, nullable) - csv, excel, pdf
- export_file_id (string, nullable, FK to report_files)
- status (enum) - pending, processing, completed, failed, cancelled
- error_message (text, nullable)
- query_sql (text, nullable) - ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ð¹ SQL Ð´Ð»Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸
- created_at (timestamp)
- completed_at (timestamp, nullable)
```

**Ð˜Ð½Ð´ÐµÐºÑÑ‹:**
- `(custom_report_id, created_at)`
- `(user_id, created_at)`
- `(status, created_at)`

---

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð°: `custom_report_schedules`

ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```sql
- id (bigint, PK)
- custom_report_id (FK)
- organization_id (FK)
- user_id (FK) - Ð²Ð»Ð°Ð´ÐµÐ»ÐµÑ† Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ
- schedule_type (enum) - daily, weekly, monthly, custom_cron
- schedule_config (json)
  {
    "time": "09:00",
    "day_of_week": 1, // Ð´Ð»Ñ weekly (1=Monday)
    "day_of_month": 1, // Ð´Ð»Ñ monthly
    "cron_expression": "0 9 * * 1" // Ð´Ð»Ñ custom_cron
  }
- filters_preset (json) - Ð¿Ñ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐºÐ°
- recipient_emails (json) - ÑÐ¿Ð¸ÑÐ¾Ðº email Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸
  ["user1@example.com", "user2@example.com"]
- export_format (enum) - csv, excel, pdf
- is_active (boolean)
- last_run_at (timestamp, nullable)
- next_run_at (timestamp, nullable)
- last_execution_id (FK to custom_report_executions, nullable)
- created_at, updated_at
```

**Ð˜Ð½Ð´ÐµÐºÑÑ‹:**
- `(custom_report_id, is_active)`
- `(next_run_at, is_active)`
- `(organization_id)`

---

### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»: `config/custom-reports.php`

ÐœÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð° Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ).

```php
return [
    'data_sources' => [
        'projects' => [
            'table' => 'projects',
            'model' => \App\Models\Project::class,
            'label' => 'ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹',
            'category' => 'core',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID', 'filterable' => true, 'sortable' => true],
                'name' => ['type' => 'string', 'label' => 'ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ', 'filterable' => true, 'sortable' => true],
                'address' => ['type' => 'string', 'label' => 'ÐÐ´Ñ€ÐµÑ', 'filterable' => true],
                'budget_amount' => ['type' => 'decimal', 'label' => 'Ð‘ÑŽÐ´Ð¶ÐµÑ‚', 'aggregatable' => true, 'format' => 'currency'],
                'status' => ['type' => 'enum', 'label' => 'Ð¡Ñ‚Ð°Ñ‚ÑƒÑ', 'filterable' => true, 'options' => ['active', 'completed', 'on_hold']],
                'start_date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°', 'filterable' => true, 'sortable' => true],
                'end_date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ', 'filterable' => true, 'sortable' => true],
                'is_archived' => ['type' => 'boolean', 'label' => 'ÐÑ€Ñ…Ð¸Ð²Ð½Ñ‹Ð¹', 'filterable' => true],
                'organization_id' => ['type' => 'integer', 'label' => 'ID Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸', 'filterable' => true],
            ],
            'relations' => [
                'organization' => [
                    'type' => 'belongsTo',
                    'target' => 'organizations',
                    'foreign_key' => 'organization_id',
                    'owner_key' => 'id',
                ],
                'contracts' => [
                    'type' => 'hasMany',
                    'target' => 'contracts',
                    'foreign_key' => 'project_id',
                    'local_key' => 'id',
                ],
                'materialReceipts' => [
                    'type' => 'hasMany',
                    'target' => 'material_receipts',
                    'foreign_key' => 'project_id',
                    'local_key' => 'id',
                ],
                'completedWorks' => [
                    'type' => 'hasMany',
                    'target' => 'completed_works',
                    'foreign_key' => 'project_id',
                    'local_key' => 'id',
                ],
            ],
            'default_filters' => [
                ['field' => 'organization_id', 'operator' => '=', 'value' => ':current_organization_id'],
                ['field' => 'is_archived', 'operator' => '=', 'value' => false],
            ],
        ],
        
        'contracts' => [
            'table' => 'contracts',
            'model' => \App\Models\Contract::class,
            'label' => 'ÐšÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹',
            'category' => 'finances',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'number' => ['type' => 'string', 'label' => 'ÐÐ¾Ð¼ÐµÑ€ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°'],
                'date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°'],
                'total_amount' => ['type' => 'decimal', 'label' => 'Ð¡ÑƒÐ¼Ð¼Ð°', 'aggregatable' => true, 'format' => 'currency'],
                'status' => ['type' => 'enum', 'label' => 'Ð¡Ñ‚Ð°Ñ‚ÑƒÑ', 'filterable' => true],
                'project_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°', 'filterable' => true],
                'contractor_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ð¾Ð´Ñ€ÑÐ´Ñ‡Ð¸ÐºÐ°', 'filterable' => true],
            ],
            'relations' => [
                'project' => ['type' => 'belongsTo', 'target' => 'projects'],
                'contractor' => ['type' => 'belongsTo', 'target' => 'contractors'],
                'payments' => ['type' => 'hasMany', 'target' => 'contract_payments'],
            ],
        ],
        
        'materials' => [
            'table' => 'materials',
            'model' => \App\Models\Material::class,
            'label' => 'ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹',
            'category' => 'materials',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'name' => ['type' => 'string', 'label' => 'ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ', 'filterable' => true],
                'code' => ['type' => 'string', 'label' => 'ÐšÐ¾Ð´', 'filterable' => true],
                'default_price' => ['type' => 'decimal', 'label' => 'Ð¦ÐµÐ½Ð°', 'aggregatable' => true, 'format' => 'currency'],
                'category' => ['type' => 'string', 'label' => 'ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ', 'filterable' => true],
            ],
            'relations' => [
                'organization' => ['type' => 'belongsTo', 'target' => 'organizations'],
                'measurementUnit' => ['type' => 'belongsTo', 'target' => 'measurement_units'],
                'receipts' => ['type' => 'hasMany', 'target' => 'material_receipts'],
            ],
        ],
        
        'completed_works' => [
            'table' => 'completed_works',
            'model' => \App\Models\CompletedWork::class,
            'label' => 'Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹',
            'category' => 'works',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'work_date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹', 'filterable' => true],
                'quantity' => ['type' => 'decimal', 'label' => 'ÐžÐ±ÑŠÐµÐ¼', 'aggregatable' => true],
                'total_cost' => ['type' => 'decimal', 'label' => 'Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ', 'aggregatable' => true, 'format' => 'currency'],
                'project_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°', 'filterable' => true],
                'work_type_id' => ['type' => 'integer', 'label' => 'ID Ð²Ð¸Ð´Ð° Ñ€Ð°Ð±Ð¾Ñ‚', 'filterable' => true],
            ],
            'relations' => [
                'project' => ['type' => 'belongsTo', 'target' => 'projects'],
                'workType' => ['type' => 'belongsTo', 'target' => 'work_types'],
                'user' => ['type' => 'belongsTo', 'target' => 'users'],
            ],
        ],
        
        'users' => [
            'table' => 'users',
            'model' => \App\Models\User::class,
            'label' => 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸',
            'category' => 'staff',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'name' => ['type' => 'string', 'label' => 'Ð˜Ð¼Ñ', 'filterable' => true],
                'email' => ['type' => 'string', 'label' => 'Email', 'filterable' => true],
                'created_at' => ['type' => 'datetime', 'label' => 'Ð”Ð°Ñ‚Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸', 'filterable' => true],
            ],
            'relations' => [
                'organizations' => ['type' => 'belongsToMany', 'target' => 'organizations'],
                'projects' => ['type' => 'belongsToMany', 'target' => 'projects'],
            ],
        ],
        
        'contractors' => [
            'table' => 'contractors',
            'model' => \App\Models\Contractor::class,
            'label' => 'ÐŸÐ¾Ð´Ñ€ÑÐ´Ñ‡Ð¸ÐºÐ¸',
            'category' => 'finances',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'name' => ['type' => 'string', 'label' => 'ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ', 'filterable' => true],
                'inn' => ['type' => 'string', 'label' => 'Ð˜ÐÐ', 'filterable' => true],
                'contact_person' => ['type' => 'string', 'label' => 'ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð¾Ðµ Ð»Ð¸Ñ†Ð¾'],
                'phone' => ['type' => 'string', 'label' => 'Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½'],
            ],
            'relations' => [
                'organization' => ['type' => 'belongsTo', 'target' => 'organizations'],
                'contracts' => ['type' => 'hasMany', 'target' => 'contracts'],
            ],
        ],
        
        'material_receipts' => [
            'table' => 'material_receipts',
            'model' => \App\Models\MaterialReceipt::class,
            'label' => 'ÐŸÑ€Ð¸ÐµÐ¼ÐºÐ¸ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²',
            'category' => 'materials',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'receipt_date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¸ÐµÐ¼ÐºÐ¸', 'filterable' => true],
                'quantity' => ['type' => 'decimal', 'label' => 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾', 'aggregatable' => true],
                'price_per_unit' => ['type' => 'decimal', 'label' => 'Ð¦ÐµÐ½Ð° Ð·Ð° ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñƒ', 'format' => 'currency'],
                'total_price' => ['type' => 'decimal', 'label' => 'ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ', 'aggregatable' => true, 'format' => 'currency'],
                'project_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°', 'filterable' => true],
                'material_id' => ['type' => 'integer', 'label' => 'ID Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°', 'filterable' => true],
            ],
            'relations' => [
                'project' => ['type' => 'belongsTo', 'target' => 'projects'],
                'material' => ['type' => 'belongsTo', 'target' => 'materials'],
                'supplier' => ['type' => 'belongsTo', 'target' => 'suppliers'],
            ],
        ],
        
        'time_entries' => [
            'table' => 'time_entries',
            'model' => \App\Models\TimeEntry::class,
            'label' => 'Ð£Ñ‡ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸',
            'category' => 'staff',
            'fields' => [
                'id' => ['type' => 'integer', 'label' => 'ID'],
                'date' => ['type' => 'date', 'label' => 'Ð”Ð°Ñ‚Ð°', 'filterable' => true],
                'hours' => ['type' => 'decimal', 'label' => 'Ð§Ð°ÑÑ‹', 'aggregatable' => true],
                'user_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ', 'filterable' => true],
                'project_id' => ['type' => 'integer', 'label' => 'ID Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°', 'filterable' => true],
            ],
            'relations' => [
                'user' => ['type' => 'belongsTo', 'target' => 'users'],
                'project' => ['type' => 'belongsTo', 'target' => 'projects'],
            ],
        ],
    ],
    
    'limits' => [
        'max_joins' => 7,
        'max_result_rows' => 10000,
        'query_timeout_seconds' => 30,
        'max_aggregations' => 10,
        'max_filters' => 20,
        'max_columns' => 50,
    ],
    
    'allowed_operators' => [
        '=' => 'Ð Ð°Ð²Ð½Ð¾',
        '!=' => 'ÐÐµ Ñ€Ð°Ð²Ð½Ð¾',
        '>' => 'Ð‘Ð¾Ð»ÑŒÑˆÐµ',
        '<' => 'ÐœÐµÐ½ÑŒÑˆÐµ',
        '>=' => 'Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð¸Ð»Ð¸ Ñ€Ð°Ð²Ð½Ð¾',
        '<=' => 'ÐœÐµÐ½ÑŒÑˆÐµ Ð¸Ð»Ð¸ Ñ€Ð°Ð²Ð½Ð¾',
        'like' => 'Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚',
        'not_like' => 'ÐÐµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚',
        'in' => 'Ð’ ÑÐ¿Ð¸ÑÐºÐµ',
        'not_in' => 'ÐÐµ Ð² ÑÐ¿Ð¸ÑÐºÐµ',
        'between' => 'ÐœÐµÐ¶Ð´Ñƒ',
        'is_null' => 'ÐŸÑƒÑÑ‚Ð¾',
        'is_not_null' => 'ÐÐµ Ð¿ÑƒÑÑ‚Ð¾',
    ],
    
    'aggregation_functions' => [
        'sum' => 'Ð¡ÑƒÐ¼Ð¼Ð°',
        'avg' => 'Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ',
        'count' => 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾',
        'min' => 'ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼',
        'max' => 'ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼',
        'count_distinct' => 'Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ',
    ],
    
    'export_formats' => [
        'csv' => 'CSV',
        'excel' => 'Excel (XLSX)',
        'pdf' => 'PDF',
    ],
    
    'cache' => [
        'enabled' => true,
        'ttl' => 3600,
        'prefix' => 'custom_report',
    ],
];
```

---

## ðŸ”§ ÐœÐ¾Ð´ÐµÐ»Ð¸ Eloquent

### CustomReport.php

```php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use Illuminate\Database\Eloquent\Relations\BelongsTo;
use Illuminate\Database\Eloquent\Relations\HasMany;

class CustomReport extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'name',
        'description',
        'organization_id',
        'user_id',
        'report_category',
        'data_sources',
        'query_config',
        'columns_config',
        'filters_config',
        'aggregations_config',
        'sorting_config',
        'visualization_config',
        'is_shared',
        'is_favorite',
        'is_scheduled',
        'execution_count',
        'last_executed_at',
    ];

    protected $casts = [
        'data_sources' => 'array',
        'query_config' => 'array',
        'columns_config' => 'array',
        'filters_config' => 'array',
        'aggregations_config' => 'array',
        'sorting_config' => 'array',
        'visualization_config' => 'array',
        'is_shared' => 'boolean',
        'is_favorite' => 'boolean',
        'is_scheduled' => 'boolean',
        'execution_count' => 'integer',
        'last_executed_at' => 'datetime',
    ];

    public function organization(): BelongsTo
    {
        return $this->belongsTo(Organization::class);
    }

    public function user(): BelongsTo
    {
        return $this->belongsTo(User::class);
    }

    public function executions(): HasMany
    {
        return $this->hasMany(CustomReportExecution::class);
    }

    public function schedules(): HasMany
    {
        return $this->hasMany(CustomReportSchedule::class);
    }

    public function incrementExecutionCount(): void
    {
        $this->increment('execution_count');
        $this->update(['last_executed_at' => now()]);
    }
}
```

### CustomReportExecution.php

```php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class CustomReportExecution extends Model
{
    const STATUS_PENDING = 'pending';
    const STATUS_PROCESSING = 'processing';
    const STATUS_COMPLETED = 'completed';
    const STATUS_FAILED = 'failed';
    const STATUS_CANCELLED = 'cancelled';

    protected $fillable = [
        'custom_report_id',
        'user_id',
        'organization_id',
        'applied_filters',
        'execution_time_ms',
        'result_rows_count',
        'export_format',
        'export_file_id',
        'status',
        'error_message',
        'query_sql',
        'completed_at',
    ];

    protected $casts = [
        'applied_filters' => 'array',
        'execution_time_ms' => 'integer',
        'result_rows_count' => 'integer',
        'completed_at' => 'datetime',
    ];

    public function customReport(): BelongsTo
    {
        return $this->belongsTo(CustomReport::class);
    }

    public function user(): BelongsTo
    {
        return $this->belongsTo(User::class);
    }

    public function exportFile(): BelongsTo
    {
        return $this->belongsTo(ReportFile::class, 'export_file_id');
    }
}
```

### CustomReportSchedule.php

```php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class CustomReportSchedule extends Model
{
    const TYPE_DAILY = 'daily';
    const TYPE_WEEKLY = 'weekly';
    const TYPE_MONTHLY = 'monthly';
    const TYPE_CUSTOM_CRON = 'custom_cron';

    protected $fillable = [
        'custom_report_id',
        'organization_id',
        'user_id',
        'schedule_type',
        'schedule_config',
        'filters_preset',
        'recipient_emails',
        'export_format',
        'is_active',
        'last_run_at',
        'next_run_at',
        'last_execution_id',
    ];

    protected $casts = [
        'schedule_config' => 'array',
        'filters_preset' => 'array',
        'recipient_emails' => 'array',
        'is_active' => 'boolean',
        'last_run_at' => 'datetime',
        'next_run_at' => 'datetime',
    ];

    public function customReport(): BelongsTo
    {
        return $this->belongsTo(CustomReport::class);
    }

    public function user(): BelongsTo
    {
        return $this->belongsTo(User::class);
    }

    public function lastExecution(): BelongsTo
    {
        return $this->belongsTo(CustomReportExecution::class, 'last_execution_id');
    }
}
```

---

## ðŸ› ï¸ Ð¡ÐµÑ€Ð²Ð¸ÑÑ‹

### ReportDataSourceRegistry.php

Ð ÐµÐ³Ð¸ÑÑ‚Ñ€ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ… - Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ñ… Ð¸ Ð¿Ð¾Ð»ÑÑ….

```php
namespace App\Services\Report;

class ReportDataSourceRegistry
{
    protected array $dataSources;

    public function __construct()
    {
        $this->dataSources = config('custom-reports.data_sources');
    }

    public function getAllDataSources(): array;
    public function getDataSource(string $key): ?array;
    public function getAvailableFields(string $dataSourceKey): array;
    public function getAvailableRelations(string $dataSourceKey): array;
    public function getFieldMetadata(string $dataSourceKey, string $fieldKey): ?array;
    public function isFieldAggregatable(string $dataSourceKey, string $fieldKey): bool;
    public function isFieldFilterable(string $dataSourceKey, string $fieldKey): bool;
    public function validateDataSource(string $dataSourceKey): bool;
    public function validateRelation(string $fromSource, string $relationKey): bool;
}
```

### CustomReportBuilderService.php

ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```php
namespace App\Services\Report;

class CustomReportBuilderService
{
    public function __construct(
        protected ReportDataSourceRegistry $registry,
        protected ReportQueryBuilder $queryBuilder
    ) {}

    public function validateReportConfig(array $config): array;
    public function buildQueryFromConfig(CustomReport $report): Builder;
    public function testReportQuery(CustomReport $report, array $filters = []): array;
    public function estimateQueryComplexity(array $config): int;
    public function suggestOptimizations(array $config): array;
    public function cloneReport(CustomReport $report, int $userId): CustomReport;
}
```

### CustomReportExecutionService.php

Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸ÐµÐ¼ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð² Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¾Ð¼.

```php
namespace App\Services\Report;

class CustomReportExecutionService
{
    public function __construct(
        protected CustomReportBuilderService $builder,
        protected ReportFilterBuilder $filterBuilder,
        protected ReportAggregationBuilder $aggregationBuilder,
        protected CsvExporterService $csvExporter,
        protected ExcelExporterService $excelExporter,
        protected LoggingService $logging
    ) {}

    public function executeReport(
        CustomReport $report,
        array $filters = [],
        ?string $exportFormat = null,
        ?int $userId = null
    ): array|StreamedResponse;

    protected function createExecution(CustomReport $report, array $filters, int $userId): CustomReportExecution;
    protected function applyUserFilters(Builder $query, array $filters, array $filtersConfig): Builder;
    protected function executeQuery(Builder $query, int $limit): Collection;
    protected function formatResults(Collection $results, array $columnsConfig): array;
    protected function exportResults(Collection $results, CustomReport $report, string $format): StreamedResponse;
    protected function updateExecutionStatus(CustomReportExecution $execution, string $status, array $data = []): void;
}
```

### CustomReportSchedulerService.php

Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```php
namespace App\Services\Report;

class CustomReportSchedulerService
{
    public function __construct(
        protected CustomReportExecutionService $executionService,
        protected LoggingService $logging
    ) {}

    public function createSchedule(CustomReport $report, array $scheduleData): CustomReportSchedule;
    public function updateSchedule(CustomReportSchedule $schedule, array $data): CustomReportSchedule;
    public function executeScheduledReports(): void;
    public function calculateNextRunTime(CustomReportSchedule $schedule): Carbon;
    public function sendReportByEmail(CustomReport $report, array $recipients, string $filePath): void;
    public function deactivateSchedule(CustomReportSchedule $schedule): void;
}
```

### ReportQueryBuilder.php

ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ SQL Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸.

```php
namespace App\Services\Report\Builders;

use Illuminate\Database\Eloquent\Builder;

class ReportQueryBuilder
{
    public function __construct(
        protected ReportDataSourceRegistry $registry,
        protected ReportFilterBuilder $filterBuilder,
        protected ReportAggregationBuilder $aggregationBuilder
    ) {}

    public function buildFromConfig(array $config, int $organizationId): Builder;
    protected function buildBaseQuery(string $primarySource, int $organizationId): Builder;
    protected function applyJoins(Builder $query, array $joins): Builder;
    protected function applyWhereConditions(Builder $query, array $conditions): Builder;
    protected function applyDefaultFilters(Builder $query, string $dataSource, int $organizationId): Builder;
    protected function selectColumns(Builder $query, array $columnsConfig): Builder;
    protected function applySorting(Builder $query, array $sortingConfig): Builder;
}
```

### ReportFilterBuilder.php

ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð² WHERE.

```php
namespace App\Services\Report\Builders;

class ReportFilterBuilder
{
    public function applyFilter(Builder $query, array $filter): Builder;
    protected function applyEqualsFilter(Builder $query, string $field, $value): Builder;
    protected function applyLikeFilter(Builder $query, string $field, string $value): Builder;
    protected function applyInFilter(Builder $query, string $field, array $values): Builder;
    protected function applyBetweenFilter(Builder $query, string $field, array $range): Builder;
    protected function applyNullFilter(Builder $query, string $field, bool $isNull): Builder;
    public function validateFilter(array $filter, string $dataSource): bool;
}
```

### ReportAggregationBuilder.php

ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¹ Ð¸ Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²Ð¾Ðº.

```php
namespace App\Services\Report\Builders;

class ReportAggregationBuilder
{
    public function applyAggregations(Builder $query, array $config): Builder;
    protected function applyGroupBy(Builder $query, array $groupByFields): Builder;
    protected function applyAggregationFunctions(Builder $query, array $aggregations): Builder;
    protected function applyHavingConditions(Builder $query, array $havingConditions): Builder;
    public function validateAggregations(array $config, string $dataSource): bool;
}
```

### ReportQueryOptimizer.php

ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð².

```php
namespace App\Services\Report;

class ReportQueryOptimizer
{
    public function optimizeQuery(Builder $query): Builder;
    public function addEagerLoading(Builder $query, array $relations): Builder;
    public function estimateQueryCost(Builder $query): int;
    public function validateQueryPerformance(Builder $query): bool;
    public function suggestIndexes(array $config): array;
}
```

### ReportVisualizationService.php

ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð² (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾).

```php
namespace App\Services\Report;

class ReportVisualizationService
{
    public function generateChartData(Collection $results, array $chartConfig): array;
    public function getSupportedChartTypes(): array;
    protected function prepareLineChartData(Collection $results, array $config): array;
    protected function prepareBarChartData(Collection $results, array $config): array;
    protected function preparePieChartData(Collection $results, array $config): array;
}
```

---

## ðŸŒ API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹

### CustomReportController.php

CRUD Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```
GET    /api/v1/admin/custom-reports
       Query params: category, is_shared, is_favorite, page, per_page
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¿Ð¸ÑÐ¾Ðº Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð¾Ð±Ñ‰Ð¸Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸

POST   /api/v1/admin/custom-reports
       Body: name, description, report_category, data_sources, query_config,
             columns_config, filters_config, aggregations_config, sorting_config,
             visualization_config, is_shared
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚

GET    /api/v1/admin/custom-reports/{id}
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð´ÐµÑ‚Ð°Ð»Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

PUT    /api/v1/admin/custom-reports/{id}
       Body: Ñ‚Ðµ Ð¶Ðµ Ð¿Ð¾Ð»Ñ Ñ‡Ñ‚Ð¾ Ð¸ Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚

DELETE /api/v1/admin/custom-reports/{id}
       Soft delete Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

POST   /api/v1/admin/custom-reports/{id}/clone
       Body: name (Ð½Ð¾Ð²Ð¾Ðµ Ð¸Ð¼Ñ)
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚

POST   /api/v1/admin/custom-reports/{id}/favorite
       Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ/ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾

POST   /api/v1/admin/custom-reports/{id}/share
       Body: is_shared (boolean)
       Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ‰Ð¸Ð¼ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼
```

### CustomReportBuilderController.php

Ð’ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð´Ð»Ñ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€Ð°.

```
GET    /api/v1/admin/custom-reports/builder/data-sources
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸

GET    /api/v1/admin/custom-reports/builder/data-sources/{source}/fields
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð¿Ð¾Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…

GET    /api/v1/admin/custom-reports/builder/data-sources/{source}/relations
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ ÑÐ²ÑÐ·Ð¸ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ð¼Ð¸

POST   /api/v1/admin/custom-reports/builder/validate
       Body: ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ (Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð¸Ð»Ð¸ ÑƒÑÐ¿ÐµÑ…)

POST   /api/v1/admin/custom-reports/builder/preview
       Body: ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° + Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð¿ÐµÑ€Ð²Ñ‹Ðµ 20 ÑÑ‚Ñ€Ð¾Ðº Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð° Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°

GET    /api/v1/admin/custom-reports/builder/operators
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð² Ð´Ð»Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²

GET    /api/v1/admin/custom-reports/builder/aggregations
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð°Ð³Ñ€ÐµÐ³Ð°Ñ‚Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
```

### CustomReportExecutionController.php

Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```
POST   /api/v1/admin/custom-reports/{id}/execute
       Body: filters (Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹)
       Query params: export (csv|excel|pdf), limit, page
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð¸Ð»Ð¸ Ñ„Ð°Ð¹Ð» ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð°

GET    /api/v1/admin/custom-reports/{id}/executions
       Query params: page, per_page, status
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

GET    /api/v1/admin/custom-reports/executions/{executionId}
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð´ÐµÑ‚Ð°Ð»Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ

POST   /api/v1/admin/custom-reports/{id}/export
       Body: filters, format (csv|excel|pdf)
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ñ„Ð°Ð¹Ð» ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° (StreamedResponse)

DELETE /api/v1/admin/custom-reports/executions/{executionId}
       Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¸ (Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸)
```

### CustomReportScheduleController.php

Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼.

```
GET    /api/v1/admin/custom-reports/{id}/schedules
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¿Ð¸ÑÐ¾Ðº Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ð¹ Ð´Ð»Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

POST   /api/v1/admin/custom-reports/{id}/schedules
       Body: schedule_type, schedule_config, filters_preset,
             recipient_emails, export_format
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ

GET    /api/v1/admin/custom-reports/{id}/schedules/{scheduleId}
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð´ÐµÑ‚Ð°Ð»Ð¸ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ

PUT    /api/v1/admin/custom-reports/{id}/schedules/{scheduleId}
       Body: Ñ‚Ðµ Ð¶Ðµ Ð¿Ð¾Ð»Ñ Ñ‡Ñ‚Ð¾ Ð¸ Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸
       Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚: Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ

DELETE /api/v1/admin/custom-reports/{id}/schedules/{scheduleId}
       Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ

POST   /api/v1/admin/custom-reports/{id}/schedules/{scheduleId}/toggle
       ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ/Ð´ÐµÐ°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ

POST   /api/v1/admin/custom-reports/{id}/schedules/{scheduleId}/run-now
       ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ
```

---

## ðŸ”’ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

### Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ SQL-Ð¸Ð½ÑŠÐµÐºÑ†Ð¸Ð¹

1. **Whitelist Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…** - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð¸Ð· config
2. **Whitelist Ð¿Ð¾Ð»ÐµÐ¹** - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾Ð»Ñ, Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð² ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
3. **Whitelist Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð²** - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²
4. **ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Query Builder Eloquent
5. **Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÑÐ²ÑÐ·ÐµÐ¹** - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð½Ñ‹Ðµ JOIN'Ñ‹

### ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°

1. **Middleware** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° `module.access:advanced-reports`
2. **Permission** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° `advanced_reports.custom_reports`
3. **Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¹** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ `organization_id`
4. **ÐŸÑ€Ð°Ð²Ð° Ð½Ð° Ð¾Ñ‚Ñ‡ÐµÑ‚** - Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ²Ð¾Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ (ÐºÑ€Ð¾Ð¼Ðµ shared)

### ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸

1. **Ð›Ð¸Ð¼Ð¸Ñ‚ JOIN'Ð¾Ð²** - Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 7 ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð°Ð±Ð»Ð¸Ñ†
2. **Ð›Ð¸Ð¼Ð¸Ñ‚ ÑÑ‚Ñ€Ð¾Ðº** - Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 10,000 ÑÑ‚Ñ€Ð¾Ðº Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
3. **Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚** - Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 30 ÑÐµÐºÑƒÐ½Ð´ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
4. **Throttling** - Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² (rate limiting)
5. **ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ** - Ð±Ð¾Ð»ÑŒÑˆÐ¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ Ñ‡ÐµÑ€ÐµÐ· Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ (Jobs)

### Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸

```php
// ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ Ð² CustomReportBuilderService
public function validateReportConfig(array $config): array
{
    $errors = [];

    if (!isset($config['data_sources']['primary'])) {
        $errors[] = 'Primary data source is required';
    }

    $primarySource = $config['data_sources']['primary'] ?? null;
    if ($primarySource && !$this->registry->validateDataSource($primarySource)) {
        $errors[] = "Invalid data source: {$primarySource}";
    }

    if (isset($config['data_sources']['joins'])) {
        if (count($config['data_sources']['joins']) > config('custom-reports.limits.max_joins')) {
            $errors[] = 'Too many joins';
        }
    }

    return $errors;
}
```

---

## ðŸ“‹ Console Commands

### ExecuteScheduledReportsCommand.php

Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ð¿Ð¾ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÑŽ (Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð¸Ð· CRON).

```php
php artisan custom-reports:execute-scheduled
```

```php
namespace App\Console\Commands;

use App\Services\Report\CustomReportSchedulerService;
use Illuminate\Console\Command;

class ExecuteScheduledReportsCommand extends Command
{
    protected $signature = 'custom-reports:execute-scheduled';
    protected $description = 'Execute scheduled custom reports';

    public function __construct(
        protected CustomReportSchedulerService $schedulerService
    ) {
        parent::__construct();
    }

    public function handle(): int
    {
        $this->info('Executing scheduled reports...');
        
        $this->schedulerService->executeScheduledReports();
        
        $this->info('Done!');
        return Command::SUCCESS;
    }
}
```

Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² `app/Console/Kernel.php`:

```php
protected function schedule(Schedule $schedule)
{
    $schedule->command('custom-reports:execute-scheduled')
        ->everyFiveMinutes()
        ->withoutOverlapping();
}
```

### CleanupOldReportExecutionsCommand.php

ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð².

```php
php artisan custom-reports:cleanup-executions --days=30
```

---

## ðŸ“Š ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²

### ÐŸÑ€Ð¸Ð¼ÐµÑ€ 1: Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼

```json
{
  "name": "Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼",
  "description": "Ð¡ÑƒÐ¼Ð¼Ñ‹ Ð¿Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð¼ Ð¿Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼",
  "report_category": "finances",
  "data_sources": {
    "primary": "projects",
    "joins": [
      {
        "table": "contracts",
        "type": "left",
        "on": ["projects.id", "contracts.project_id"]
      },
      {
        "table": "completed_works",
        "type": "left",
        "on": ["projects.id", "completed_works.project_id"]
      }
    ]
  },
  "columns_config": [
    {
      "field": "projects.name",
      "label": "ÐŸÑ€Ð¾ÐµÐºÑ‚",
      "order": 1,
      "format": "text"
    },
    {
      "field": "projects.budget_amount",
      "label": "Ð‘ÑŽÐ´Ð¶ÐµÑ‚",
      "order": 2,
      "format": "currency"
    },
    {
      "field": "contracts.total_amount",
      "label": "Ð¡ÑƒÐ¼Ð¼Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²",
      "order": 3,
      "format": "currency",
      "aggregation": "sum"
    },
    {
      "field": "completed_works.total_cost",
      "label": "Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚",
      "order": 4,
      "format": "currency",
      "aggregation": "sum"
    }
  ],
  "filters_config": [
    {
      "field": "projects.status",
      "label": "Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",
      "type": "select",
      "options": ["active", "completed"],
      "required": false
    },
    {
      "field": "projects.start_date",
      "label": "ÐŸÐµÑ€Ð¸Ð¾Ð´",
      "type": "date_range",
      "required": true
    }
  ],
  "aggregations_config": {
    "group_by": ["projects.id", "projects.name", "projects.budget_amount"],
    "aggregations": [
      {
        "field": "contracts.total_amount",
        "function": "sum",
        "alias": "total_contracts"
      },
      {
        "field": "completed_works.total_cost",
        "function": "sum",
        "alias": "total_works"
      }
    ]
  },
  "sorting_config": [
    {
      "field": "total_contracts",
      "direction": "desc"
    }
  ]
}
```

### ÐŸÑ€Ð¸Ð¼ÐµÑ€ 2: ÐžÑ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²

```json
{
  "name": "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð² Ð¿Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼",
  "description": "ÐŸÑ€Ð¸Ñ…Ð¾Ð´ Ð¸ Ñ€Ð°ÑÑ…Ð¾Ð´ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð² Ð¿Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼",
  "report_category": "materials",
  "data_sources": {
    "primary": "materials",
    "joins": [
      {
        "table": "material_receipts",
        "type": "left",
        "on": ["materials.id", "material_receipts.material_id"]
      },
      {
        "table": "projects",
        "type": "inner",
        "on": ["material_receipts.project_id", "projects.id"]
      }
    ]
  },
  "columns_config": [
    {
      "field": "materials.name",
      "label": "ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»",
      "order": 1
    },
    {
      "field": "projects.name",
      "label": "ÐŸÑ€Ð¾ÐµÐºÑ‚",
      "order": 2
    },
    {
      "field": "material_receipts.quantity",
      "label": "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",
      "order": 3,
      "aggregation": "sum"
    },
    {
      "field": "material_receipts.total_price",
      "label": "Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ",
      "order": 4,
      "format": "currency",
      "aggregation": "sum"
    }
  ],
  "filters_config": [
    {
      "field": "material_receipts.receipt_date",
      "label": "ÐŸÐµÑ€Ð¸Ð¾Ð´",
      "type": "date_range",
      "required": true
    },
    {
      "field": "materials.category",
      "label": "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°",
      "type": "text",
      "required": false
    }
  ],
  "aggregations_config": {
    "group_by": ["materials.id", "materials.name", "projects.id", "projects.name"],
    "aggregations": [
      {
        "field": "material_receipts.quantity",
        "function": "sum",
        "alias": "total_quantity"
      },
      {
        "field": "material_receipts.total_price",
        "function": "sum",
        "alias": "total_cost"
      }
    ]
  }
}
```

### ÐŸÑ€Ð¸Ð¼ÐµÑ€ 3: ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ñ€Ð°Ð±Ð¾Ð²

```json
{
  "name": "ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ñ€Ð°Ð±Ð¾Ð²",
  "description": "Ð Ð°Ð±Ð¾Ñ‡ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ð¾ Ð¿Ñ€Ð¾Ñ€Ð°Ð±Ð°Ð¼",
  "report_category": "staff",
  "data_sources": {
    "primary": "users",
    "joins": [
      {
        "table": "time_entries",
        "type": "left",
        "on": ["users.id", "time_entries.user_id"]
      },
      {
        "table": "completed_works",
        "type": "left",
        "on": ["users.id", "completed_works.user_id"]
      }
    ]
  },
  "query_config": {
    "where": [
      {
        "field": "users.role",
        "operator": "=",
        "value": "foreman"
      }
    ]
  },
  "columns_config": [
    {
      "field": "users.name",
      "label": "ÐŸÑ€Ð¾Ñ€Ð°Ð±",
      "order": 1
    },
    {
      "field": "time_entries.hours",
      "label": "ÐžÑ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾ Ñ‡Ð°ÑÐ¾Ð²",
      "order": 2,
      "aggregation": "sum"
    },
    {
      "field": "completed_works.id",
      "label": "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚",
      "order": 3,
      "aggregation": "count"
    },
    {
      "field": "completed_works.total_cost",
      "label": "Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚",
      "order": 4,
      "format": "currency",
      "aggregation": "sum"
    }
  ],
  "filters_config": [
    {
      "field": "time_entries.date",
      "label": "ÐŸÐµÑ€Ð¸Ð¾Ð´",
      "type": "date_range",
      "required": true
    }
  ],
  "aggregations_config": {
    "group_by": ["users.id", "users.name"],
    "aggregations": [
      {
        "field": "time_entries.hours",
        "function": "sum",
        "alias": "total_hours"
      },
      {
        "field": "completed_works.id",
        "function": "count",
        "alias": "works_count"
      },
      {
        "field": "completed_works.total_cost",
        "function": "sum",
        "alias": "total_revenue"
      }
    ]
  },
  "sorting_config": [
    {
      "field": "total_revenue",
      "direction": "desc"
    }
  ]
}
```

---

## ðŸš€ Ð­Ñ‚Ð°Ð¿Ñ‹ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ (Roadmap)

### MVP (Ð¤Ð°Ð·Ð° 1) - 3-4 Ð½ÐµÐ´ÐµÐ»Ð¸

**Ð¦ÐµÐ»ÑŒ:** Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð» ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€Ð° Ñ Ð¾Ð´Ð½Ð¸Ð¼ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ñ….

1. **Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…** (3 Ð´Ð½Ñ)
   - ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸: custom_reports, custom_report_executions
   - ÐœÐ¾Ð´ÐµÐ»Ð¸ Eloquent
   - Seeders Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…

2. **ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…** (2 Ð´Ð½Ñ)
   - config/custom-reports.php
   - ReportDataSourceRegistry
   - ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ 5-7 Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð²

3. **Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹** (5 Ð´Ð½ÐµÐ¹)
   - CustomReportBuilderService (Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ, Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²)
   - ReportQueryBuilder (Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð±ÐµÐ· JOIN)
   - ReportFilterBuilder (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹: =, >, <, like, in)

4. **API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹ - CRUD** (4 Ð´Ð½Ñ)
   - CustomReportController (create, read, update, delete, list)
   - CustomReportBuilderController (data-sources, fields, validate, preview)
   - Request ÐºÐ»Ð°ÑÑÑ‹ Ð´Ð»Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸

5. **Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²** (3 Ð´Ð½Ñ)
   - CustomReportExecutionService
   - CustomReportExecutionController (execute, export)
   - Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¼Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ÐµÑ€Ð°Ð¼Ð¸ (CSV, Excel)

6. **Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ MVP** (2 Ð´Ð½Ñ)
   - Unit Ñ‚ÐµÑÑ‚Ñ‹ Ð´Ð»Ñ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
   - API Ñ‚ÐµÑÑ‚Ñ‹ Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð²

### Ð¤Ð°Ð·Ð° 2 - 2-3 Ð½ÐµÐ´ÐµÐ»Ð¸

**Ð¦ÐµÐ»ÑŒ:** JOIN'Ñ‹, Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¸, Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ.

7. **ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° JOIN'Ð¾Ð²** (4 Ð´Ð½Ñ)
   - Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ ReportQueryBuilder
   - Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÑÐ²ÑÐ·ÐµÐ¹ Ð¼ÐµÐ¶Ð´Ñƒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ð¼Ð¸
   - Ð¢ÐµÑÑ‚Ñ‹

8. **ÐÐ³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¸ Ð¸ Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ¸** (3 Ð´Ð½Ñ)
   - ReportAggregationBuilder
   - GROUP BY, HAVING
   - SUM, AVG, COUNT, MIN, MAX

9. **Ð Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ** (5 Ð´Ð½ÐµÐ¹)
   - ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ: custom_report_schedules
   - CustomReportSchedulerService
   - CustomReportScheduleController
   - ExecuteScheduledReportsCommand
   - Email Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²

10. **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸** (2 Ð´Ð½Ñ)
    - ReportQueryOptimizer
    - ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ…
    - Ð˜Ð½Ð´ÐµÐºÑÑ‹ Ð‘Ð”

### Ð¤Ð°Ð·Ð° 3 - 2-3 Ð½ÐµÐ´ÐµÐ»Ð¸

**Ð¦ÐµÐ»ÑŒ:** Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»Ñ, ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹.

11. **Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…** (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾, 4 Ð´Ð½Ñ)
    - ReportVisualizationService
    - ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð²
    - API Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ chart data

12. **Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»Ñ** (3 Ð´Ð½Ñ)
    - ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ„Ð¾Ñ€Ð¼ÑƒÐ» Ð² columns_config
    - Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»

13. **Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²** (3 Ð´Ð½Ñ)
    - ÐŸÑ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹
    - Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚/ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹
    - ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²

14. **Ð’ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾, 3 Ð´Ð½Ñ)
    - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
    - ÐžÑ‚ÐºÐ°Ñ‚ Ðº Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¼ Ð²ÐµÑ€ÑÐ¸ÑÐ¼

### Ð¤Ð°Ð·Ð° 4 - 2 Ð½ÐµÐ´ÐµÐ»Ð¸

**Ð¦ÐµÐ»ÑŒ:** Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸, collaboration, Ð´Ð¾Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.

15. **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸** (4 Ð´Ð½Ñ)
    - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð² Telegram
    - Webhook Ð´Ð»Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼
    - API Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

16. **Collaborative features** (3 Ð´Ð¸Ñ)
    - ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ðº Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°Ð¼
    - Ð¢ÐµÐ³Ð¸, Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð¸
    - Ð˜Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ

17. **UI Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐ¸ Ð´Ð»Ñ API** (2 Ð´Ð½Ñ)
    - Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ API (OpenAPI/Swagger)
    - ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²

18. **Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** (2 Ð´Ð½Ñ)
    - Integration Ñ‚ÐµÑÑ‚Ñ‹
    - ÐÐ°Ð³Ñ€ÑƒÐ·Ð¾Ñ‡Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
    - Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð³Ð¾Ð²

---

## ðŸ“ Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

### Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸

- Laravel 10+
- PHP 8.1+
- MySQL 8.0+ / PostgreSQL 14+
- Redis (Ð´Ð»Ñ ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹)
- Laravel Queue (Ð´Ð»Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²)

### ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ

- ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ (Ð±ÐµÐ· JOIN): < 1 ÑÐµÐº
- Ð¡Ð»Ð¾Ð¶Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ (Ñ JOIN Ð¸ Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸ÑÐ¼Ð¸): < 5 ÑÐµÐº
- ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ñ€Ð¾Ð³: 30 ÑÐµÐº (Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚)
- ÐšÑÑˆ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ…: TTL 1 Ñ‡Ð°Ñ
- ÐšÑÑˆ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾): TTL 5 Ð¼Ð¸Ð½ÑƒÑ‚

### ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ

- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð¾ 50 ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ð½Ð° Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸ÑŽ
- Ð”Ð¾ 10 Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ð¹ Ð½Ð° Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸ÑŽ
- Ð”Ð¾ 1000 Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð² Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ (Ð°Ð²Ñ‚Ð¾Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° ÑÑ‚Ð°Ñ€Ñ‹Ñ…)

---

## ðŸ” ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸

### Ð‘Ð¸Ð·Ð½ÐµÑ-Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸

- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² (total, Ð¿Ð¾ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°Ð¼)
- ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²
- Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
- ÐŸÑ€Ð¾Ñ†ÐµÐ½Ñ‚ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² Ñ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼
- ÐŸÑ€Ð¾Ñ†ÐµÐ½Ñ‚ shared Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²

### Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸

- Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
- P50, P95, P99 Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ failed Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ð¹ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ð°
- Ð Ð°Ð·Ð¼ÐµÑ€ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² (ÑÑ‚Ñ€Ð¾Ðº, Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð´Ð°Ð½Ð½Ñ‹Ñ…)

### Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

```php
// ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² CustomReportExecutionService
$this->logging->business('custom_report.executed', [
    'report_id' => $report->id,
    'report_name' => $report->name,
    'organization_id' => $report->organization_id,
    'user_id' => $userId,
    'execution_time_ms' => $executionTime,
    'result_rows_count' => $rowsCount,
    'export_format' => $exportFormat,
]);

// ÐŸÑ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ…
$this->logging->technical('custom_report.execution.failed', [
    'report_id' => $report->id,
    'error' => $exception->getMessage(),
    'execution_time_ms' => $executionTime,
], 'error');
```

---

## âš ï¸ Ð Ð¸ÑÐºÐ¸ Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ

### Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€Ð¸ÑÐºÐ¸

1. **ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²**
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* Ð»Ð¸Ð¼Ð¸Ñ‚Ñ‹ Ð½Ð° JOIN'Ñ‹, Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñ‹, Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ

2. **SQL-Ð¸Ð½ÑŠÐµÐºÑ†Ð¸Ð¸**
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* ÑÑ‚Ñ€Ð¾Ð³Ð¸Ð¹ whitelist, Query Builder, Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ

3. **ÐŸÐµÑ€ÐµÑƒÑÐ»Ð¾Ð¶Ð½ÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°**
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ, ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹, Ñ…Ð¾Ñ€Ð¾ÑˆÐ°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

4. **ÐÐ°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð° Ð‘Ð”**
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* Ð¸Ð½Ð´ÐµÐºÑÑ‹, ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ, rate limiting

### Ð‘Ð¸Ð·Ð½ÐµÑ-Ñ€Ð¸ÑÐºÐ¸

1. **ÐÐ¸Ð·ÐºÐ¾Ðµ adoption rate** (Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð½Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ)
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð², Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹

2. **Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸**
   - *ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ:* Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³, Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

---

## ðŸ“š Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹

### Frontend (Ð¾Ð±Ñ‰ÐµÐµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ)

ÐŸÐ¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ñƒ Ð²Ð°Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ API, Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°. Ð˜Ð¼ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ:

1. **ÐšÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€ (Ð²Ð¸Ð·Ð°Ñ€Ð´ Ð¸Ð· 5-7 ÑˆÐ°Ð³Ð¾Ð²)**
   - Ð’Ñ‹Ð±Ð¾Ñ€ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… (drag & drop Ð¸Ð»Ð¸ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°)
   - ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° JOIN'Ð¾Ð² (Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð°Ñ ÑÑ…ÐµÐ¼Ð° ÑÐ²ÑÐ·ÐµÐ¹)
   - Ð’Ñ‹Ð±Ð¾Ñ€ ÐºÐ¾Ð»Ð¾Ð½Ð¾Ðº (drag & drop, Ð¿ÐµÑ€ÐµÐ¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ)
   - ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð² (Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ)
   - ÐÐ³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¸ (Ð²Ñ‹Ð±Ð¾Ñ€ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹)
   - Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¸ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
   - Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°

2. **Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°**
   - Ð¤Ð¾Ñ€Ð¼Ð° Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
   - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°Ð¼Ð¸ (Ñ Ð¿Ð°Ð³Ð¸Ð½Ð°Ñ†Ð¸ÐµÐ¹)
   - ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð°
   - Ð“Ñ€Ð°Ñ„Ð¸ÐºÐ¸ (ÐµÑÐ»Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹)

3. **Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²**
   - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°Ð¼Ð¸ (Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹, ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°)
   - ÐšÐ½Ð¾Ð¿ÐºÐ¸: Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ, Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ, ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ, ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ
   - Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€: shared, favorite, scheduled

4. **Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼**
   - Ð¤Ð¾Ñ€Ð¼Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ
   - Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ð¹
   - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹

### ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ API

Ð¡Ð¼. Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ OpenAPI/Swagger (Ð±ÑƒÐ´ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ð½Ð° Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾).

### Ð¡ÑÑ‹Ð»ÐºÐ¸ Ð½Ð° ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹

- `app/Services/Export/CsvExporterService.php` - ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ CSV
- `app/Services/Export/ExcelExporterService.php` - ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ Excel
- `app/Models/ReportTemplate.php` - ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹
- `app/Models/ReportFile.php` - Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²
- `app/Services/Logging/LoggingService.php` - Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

---

## âœ… ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº (Checklist)

### ÐŸÐµÑ€ÐµÐ´ Ð½Ð°Ñ‡Ð°Ð»Ð¾Ð¼ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
- [ ] Ð¡Ð¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð‘Ð”
- [ ] Ð¡Ð¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…
- [ ] ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ (MVP vs Nice-to-have)
- [ ] Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ñ‚Ñ€ÐµÐºÐµÑ€Ðµ

### MVP
- [ ] ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸
- [ ] ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…
- [ ] ReportDataSourceRegistry
- [ ] CustomReportBuilderService (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹)
- [ ] ReportQueryBuilder (Ð±ÐµÐ· JOIN)
- [ ] ReportFilterBuilder (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹)
- [ ] CustomReportController (CRUD)
- [ ] CustomReportBuilderController (metadata)
- [ ] CustomReportExecutionService
- [ ] CustomReportExecutionController
- [ ] Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ÐµÑ€Ð°Ð¼Ð¸
- [ ] Unit Ð¸ API Ñ‚ÐµÑÑ‚Ñ‹

### Ð¤Ð°Ð·Ð° 2
- [ ] ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° JOIN'Ð¾Ð²
- [ ] ReportAggregationBuilder
- [ ] CustomReportSchedulerService
- [ ] CustomReportScheduleController
- [ ] ExecuteScheduledReportsCommand
- [ ] Email Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ°
- [ ] ReportQueryOptimizer
- [ ] ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð¤Ð°Ð·Ð° 3
- [ ] ReportVisualizationService
- [ ] Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»Ñ
- [ ] Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²
- [ ] Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚/ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹
- [ ] Ð’ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð¤Ð°Ð·Ð° 4
- [ ] Telegram Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ
- [ ] Webhook API
- [ ] ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ð¸ Ñ‚ÐµÐ³Ð¸
- [ ] OpenAPI Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
- [ ] Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

---

## ðŸŽ¯ Ð˜Ñ‚Ð¾Ð³Ð¾

ÐšÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð² - ÑÐ»Ð¾Ð¶Ð½Ð°Ñ, Ð½Ð¾ Ð¾Ñ‡ÐµÐ½ÑŒ Ñ†ÐµÐ½Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð´Ð»Ñ Ð¼Ð¾Ð´ÑƒÐ»Ñ Ð¿Ñ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ñ‹Ñ… Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð². ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ñ‹:

1. **Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµ Ð²ÑÐµÐ³Ð¾** - ÑÑ‚Ñ€Ð¾Ð³Ð°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ, whitelist, Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
2. **ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð²Ð°Ð¶Ð½Ð°** - Ð»Ð¸Ð¼Ð¸Ñ‚Ñ‹, Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñ‹, Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ, ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
3. **ÐŸÐ¾ÑÑ‚Ð°Ð¿Ð½Ð°Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°** - Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ñ MVP, Ð¿Ð¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
4. **Ð¥Ð¾Ñ€Ð¾ÑˆÐ°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ** - Ð´Ð»Ñ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´-ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
5. **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** - Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸

**ÐžÑ†ÐµÐ½ÐºÐ° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸:** 10-14 Ð½ÐµÐ´ÐµÐ»ÑŒ (2.5-3.5 Ð¼ÐµÑÑÑ†Ð°) Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ Ñ†Ð¸ÐºÐ»Ð° Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.

**Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ:** ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ MVP (1 Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº, Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹, ÑÐºÑÐ¿Ð¾Ñ€Ñ‚), Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹, Ð·Ð°Ñ‚ÐµÐ¼ Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÑ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ.

