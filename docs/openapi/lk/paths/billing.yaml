/billing/plans:
  get:
    tags: [Billing]
    summary: Список тарифных планов
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Планы
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/BillingPlan.yaml'
/billing/subscription:
  get:
    tags: [Billing]
    summary: Текущая подписка пользователя
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Подписка
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/UserSubscription.yaml'
/billing/subscribe:
  post:
    tags: [Billing]
    summary: Оформить подписку
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/SubscribeRequest.yaml'
    responses:
      "201":
        description: Подписка оформлена
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ApiResponse.yaml'
/billing/subscription/cancel:
  post:
    tags: [Billing]
    summary: Отменить подписку
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Отменена
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ApiResponse.yaml'
/billing/subscription/auto-payment:
  patch:
    tags: [Billing]
    summary: Включить/выключить автоплатеж для подписки
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/AutoPaymentToggleRequest.yaml'
    responses:
      "200":
        description: Подписка обновлена
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/UserSubscription.yaml'
/billing/balance:
  get:
    tags: [Billing]
    summary: Баланс организации
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Баланс
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationBalance.yaml'
/billing/balance/transactions:
  get:
    tags: [Billing]
    summary: Транзакции баланса
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Транзакции
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/BalanceTransaction.yaml'
/billing/balance/top-up:
  post:
    tags: [Billing]
    summary: Пополнить баланс
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              amount:
                type: number
                format: float
            required: [amount]
    responses:
      "200":
        description: Пополнено
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ApiResponse.yaml'
/billing/subscription/limits:
  get:
    tags: [Billing]
    summary: Лимиты подписки
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Лимиты
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/SubscriptionLimits.yaml'
/billing/addons:
  get:
    tags: [Billing]
    summary: Список доступных add-ons
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Список add-ons
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/AddonsResponse.yaml'
/billing/org-subscription:
  get:
    tags: [Billing]
    summary: Подписка организации
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Подписка
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationSubscription.yaml'
  patch:
    tags: [Billing]
    summary: Обновить подписку организации
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/OrgSubscribeRequest.yaml'
    responses:
      "200":
        description: Подписка обновлена
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationSubscription.yaml'
/billing/org-subscription/auto-payment:
  patch:
    tags: [Billing]
    summary: Включить/выключить автоплатеж для подписки организации
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/AutoPaymentToggleRequest.yaml'
    responses:
      "200":
        description: Подписка организации обновлена
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationSubscription.yaml'
/billing/org-subscribe:
  post:
    tags: [Billing]
    summary: Оформить/сменить подписку организации
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/OrgSubscribeRequest.yaml'
    responses:
      "201":
        description: Подписка оформлена
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationSubscription.yaml'
/billing/org-addon:
  post:
    tags: [Billing]
    summary: Подключить add-on
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/OrgAddonAttachRequest.yaml'
    responses:
      "201":
        description: Add-on подключён
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationSubscriptionAddon.yaml'
/billing/org-addon/{id}:
  parameters:
    - name: id
      in: path
      required: true
      schema: { type: integer }
  delete:
    tags: [Billing]
    summary: Отключить add-on
    security: [{ bearerAuth: [] }]
    responses:
      "204":
        description: Add-on отключён
/billing/org-one-time-purchase:
  post:
    tags: [Billing]
    summary: Совершить одноразовую покупку
    security: [{ bearerAuth: [] }]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/OneTimePurchaseRequest.yaml'
    responses:
      "201":
        description: Покупка совершена
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationOneTimePurchase.yaml'
/billing/org-one-time-purchases:
  get:
    tags: [Billing]
    summary: История одноразовых покупок
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: История
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/OrganizationOneTimePurchase.yaml'
/billing/org-dashboard:
  get:
    tags: [Billing]
    summary: Дашборд организации
    security: [{ bearerAuth: [] }]
    responses:
      "200":
        description: Данные дашборда
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      $ref: '../components/schemas/OrganizationDashboard.yaml' 