/projects:
  get:
    tags: [Projects]
    summary: Получить список проектов
    responses:
      "200":
        description: Список проектов
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/Project.yaml'
  post:
    tags: [Projects]
    summary: Создать проект
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/ProjectCreateRequest.yaml'
    responses:
      "201":
        description: Создано
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ProjectResponse.yaml'

/projects/{id}:
  get:
    tags: [Projects]
    summary: Получить проект
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Проект
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ProjectResponse.yaml'
  put:
    tags: [Projects]
    summary: Обновить проект
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/ProjectCreateRequest.yaml'
    responses:
      "200":
        description: Обновлено
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ProjectResponse.yaml'
  delete:
    tags: [Projects]
    summary: Удалить проект
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "204":
        description: Успешно удалено

/projects/available-cost-categories:
  get:
    tags: [Projects]
    summary: Получить доступные категории затрат для проектов
    responses:
      "200":
        description: Категории затрат
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/CostCategory.yaml'

/projects/{id}/statistics:
  get:
    tags: [Projects]
    summary: Получить статистику проекта
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Статистика проекта
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        project_id:
                          type: integer
                        project_name:
                          type: string
                        materials:
                          type: object
                        works:
                          type: object
                        team:
                          type: object
                          properties:
                            assigned_users_count:
                              type: integer
                            members:
                              type: array
                              items:
                                $ref: '../components/schemas/ProjectTeamMember.yaml'
                        performance_acts:
                          type: array
                          items:
                            $ref: '../components/schemas/PerformanceAct.yaml'
                        project_info:
                          type: object

/projects/{id}/materials:
  get:
    tags: [Projects]
    summary: Получить материалы проекта
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Материалы проекта
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/Material.yaml'

/projects/{id}/work-types:
  get:
    tags: [Projects]
    summary: Получить виды работ проекта
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Виды работ проекта
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/WorkType.yaml'

/projects/{projectId}/foremen/{userId}:
  post:
    tags: [Projects]
    summary: Назначить прораба на проект
    parameters:
      - in: path
        name: projectId
        required: true
        schema:
          type: integer
      - in: path
        name: userId
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Прораб назначен
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ApiResponse.yaml'
  delete:
    tags: [Projects]
    summary: Открепить прораба от проекта
    parameters:
      - in: path
        name: projectId
        required: true
        schema:
          type: integer
      - in: path
        name: userId
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Прораб откреплён
        content:
          application/json:
            schema:
              $ref: '../components/schemas/ApiResponse.yaml'

/projects/{id}/full:
  get:
    tags: [Projects]
    summary: Получить полную сводку по проекту (финансы, статистика, организация)
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Полная информация
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        project:
                          $ref: '../components/schemas/Project.yaml'
                        analytics:
                          type: object
                          properties:
                            financial:
                              type: object
                              properties:
                                contracts_total_amount:
                                  type: number
                                  format: double
                                performed_amount_by_acts:
                                  type: number
                                  format: double
                                received_payments_amount:
                                  type: number
                                  format: double
                                works_total_amount:
                                  type: number
                                  format: double
                                materials_total_amount:
                                  type: number
                                  format: double
                                overall_cost:
                                  type: number
                                  format: double
                            counts:
                              type: object
                              properties:
                                organizations:
                                  type: integer
                                contracts:
                                  type: integer
                                performance_acts:
                                  type: integer
                        organizations_stats:
                          type: array
                          items:
                            $ref: '../components/schemas/OrganizationInProject.yaml'

/projects/{id}/available-organizations:
  get:
    tags: [Projects]
    summary: Получить организации, доступные для добавления в проект
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
    responses:
      "200":
        description: Доступные организации
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas/ApiResponse.yaml'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../components/schemas/OrganizationSimple.yaml' 