openapi: 3.0.3
info:
  title: Прораб-Финанс Мост API
  description: |
    API для взаимодействия с платформой "Прораб-Финанс Мост".
    
    Платформа предназначена для устранения разрыва между полевыми данными строительства и бухгалтерским учётом.
  version: 1.0.0
  contact:
    name: Служба поддержки
    email: support@prohelper.ru
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: '{protocol}://{host}/api/v1'
    description: API сервер
    variables:
      protocol:
        enum:
          - http
          - https
        default: https
      host:
        default: prohelper.ru
        description: API хост
tags:
  - name: Авторизация (Лендинг)
    description: Методы авторизации через API лендинга (для владельцев организаций)
  - name: Авторизация (Админка)
    description: Методы авторизации через API админки (для администраторов)
  - name: Авторизация (Мобильное)
    description: Методы авторизации через API мобильного приложения (для прорабов)
  # Теги для Админки (API #2)
  - name: Проекты (Админка)
    description: Управление проектами (CRUD)
  - name: Материалы (Админка)
    description: Управление справочником материалов (CRUD)
  - name: Виды Работ (Админка)
    description: Управление справочником видов работ (CRUD)
  - name: Поставщики (Админка)
    description: Управление справочником поставщиков (CRUD)
  - name: Управление Прорабами (Админка)
    description: Управление пользователями с ролью 'foreman' (CRUD)
  - name: Организация (ЛК)
    description: Управление организацией в Личном Кабинете
  - name: Управление Администраторами (ЛК)
    description: Управление пользователями с ролью 'admin' в Личном Кабинете
  - name: Управление Пользователями Админ-Панели (ЛК)
    description: Управление пользователями с ролями для админ-панели ('web_admin', 'accountant' и т.д.) из ЛК
  - name: Поддержка (ЛК)
    description: Отправка запросов в службу поддержки из Личного Кабинета
  # Добавить теги для ЛК (Подписки, Планы, Поддержка) и Мобильного API
  - name: Логирование (Мобильное)
    description: Методы для фиксации данных прорабом (расход материалов, выполнение работ)

paths:
  /landing/auth/register:
    post:
      tags:
        - Авторизация (Лендинг)
      summary: Регистрация нового пользователя и организации
      description: Регистрирует нового владельца организации и создает организацию.
      operationId: registerLanding
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
                - password
                - password_confirmation
                - organization_name
              properties:
                name:
                  type: string
                  example: Иван Иванов
                email:
                  type: string
                  format: email
                  example: ivan@example.com
                  description: Email пользователя (используется для входа)
                password:
                  type: string
                  format: password
                  example: strongPassword123
                  description: Пароль пользователя (мин. 8 символов)
                password_confirmation:
                  type: string
                  format: password
                  example: strongPassword123
                  description: Подтверждение пароля
                phone:
                  type: string
                  example: "+7 (901) 123-45-67"
                  description: Телефон пользователя
                position:
                  type: string
                  example: "Директор"
                  description: Должность пользователя
                organization_name:
                  type: string
                  example: ООО "СтройХолдинг"
                  description: Название организации
                organization_legal_name:
                  type: string
                  example: Общество с ограниченной ответственностью "СтройХолдинг"
                  description: Юридическое название организации
                organization_tax_number:
                  type: string
                  example: "7712345678"
                  description: ИНН организации
                organization_registration_number:
                  type: string
                  example: "1234567890123"
                  description: ОГРН организации
                organization_phone:
                  type: string
                  example: "+7 (495) 123-45-67"
                  description: Телефон организации
                organization_email:
                  type: string
                  format: email
                  example: info@stroiholding.ru
                  description: Email организации
                organization_address:
                  type: string
                  example: "Москва, ул. Строителей, д. 10"
                  description: Юридический адрес организации
                organization_city:
                  type: string
                  example: "Москва"
                  description: Город организации
                organization_postal_code:
                  type: string
                  example: "123456"
                  description: Почтовый индекс организации
                organization_country:
                  type: string
                  example: "Россия"
                  description: Страна организации
      responses:
        '201':
          description: Пользователь и организация успешно созданы
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Регистрация успешна
                  token:
                    type: string
                    example: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
                  user:
                    $ref: '#/components/schemas/User'
                  organization:
                    $ref: '#/components/schemas/Organization'
        '422':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '500':
          description: Ошибка сервера
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /landing/auth/login:
    post:
      tags:
        - Авторизация (Лендинг)
      summary: Вход пользователя
      description: Аутентифицирует пользователя в API лендинга.
      operationId: loginLanding
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: ivan@example.com
                password:
                  type: string
                  format: password
                  example: strongPassword123
      responses:
        '200':
          description: Успешная авторизация
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Вход выполнен успешно
                  token:
                    type: string
                    example: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          description: Ошибка авторизации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '422':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /landing/auth/me:
    get:
      tags:
        - Авторизация (Лендинг)
      summary: Информация о текущем пользователе
      description: Возвращает информацию о текущем авторизованном пользователе.
      operationId: meAuthLanding
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          description: Пользователь не авторизован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'

  /landing/auth/refresh:
    post:
      tags:
        - Авторизация (Лендинг)
      summary: Обновление токена
      description: Обновляет JWT токен.
      operationId: refreshLanding
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Токен успешно обновлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Токен успешно обновлен
                  token:
                    type: string
                    example: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
        '401':
          description: Ошибка обновления токена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'

  /landing/auth/logout:
    post:
      tags:
        - Авторизация (Лендинг)
      summary: Выход пользователя
      description: Инвалидирует JWT токен текущего пользователя.
      operationId: logoutLanding
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Успешный выход
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Выход выполнен успешно
        '401':
          description: Пользователь не авторизован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'

  /admin/auth/login:
    post:
      tags:
        - Авторизация (Админка)
      summary: Вход пользователя (админка)
      description: Аутентифицирует пользователя в API админки.
      operationId: loginAdmin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: admin@example.com
                password:
                  type: string
                  format: password
                  example: adminPassword123
      responses:
        '200':
          description: Успешная авторизация
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Вход выполнен успешно
                  token:
                    type: string
                    example: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          description: Ошибка авторизации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '403':
          description: Доступ запрещен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: У вас нет доступа к панели администратора
        '422':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  # --- API Личного Кабинета (ЛК) --- 
  
  /landing/users:
    get:
      tags: [Управление Администраторами (ЛК)]
      summary: Список администраторов организации
      description: Возвращает список пользователей с ролью 'admin' в текущей организации владельца.
      operationId: getLandingAdmins
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ со списком администраторов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Если не владелец
    post:
      tags: [Управление Администраторами (ЛК)]
      summary: Создание нового администратора
      description: Владелец организации создает нового пользователя с ролью 'admin'.
      operationId: createLandingAdmin
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreAdminRequest'
      responses:
        '201':
          description: Администратор успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessCreationAdminUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Если не владелец
        '422': { $ref: '#/components/responses/ValidationError' }
        '500': { $ref: '#/components/responses/ServerError' } # Роль 'admin' не найдена?

  /landing/users/{user}:
    get:
      tags: [Управление Администраторами (ЛК)]
      summary: Получение информации об администраторе
      operationId: getLandingAdmin
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя-администратора
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Управление Администраторами (ЛК)]
      summary: Обновление информации об администраторе
      operationId: updateLandingAdmin
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя-администратора
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAdminRequest'
      responses:
        '200':
          description: Администратор успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Управление Администраторами (ЛК)]
      summary: Удаление администратора
      operationId: deleteLandingAdmin
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя-администратора
          schema: { type: integer }
      responses:
        '204':
          description: Администратор успешно удален
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Не владелец или пытается удалить себя
        '404': { $ref: '#/components/responses/NotFoundError' }
        
  # --- API Админки --- 
  
  /admin/projects:
    get:
      tags: [Проекты (Админка)]
      summary: Список проектов организации
      operationId: getAdminProjects
      security: [{ bearerAuth: [] }]
      parameters:
        # TODO: Добавить параметры пагинации, фильтрации, сортировки
        - name: per_page
          in: query
          schema: { type: integer, default: 15 }
        - name: page
          in: query
          schema: { type: integer, default: 1 }
      responses:
        '200':
          description: Успешный ответ со списком проектов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
    post:
      tags: [Проекты (Админка)]
      summary: Создание нового проекта
      operationId: createAdminProject
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreProjectRequest'
      responses:
        '201':
          description: Проект успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Если используется Gate/Policy
        '422': { $ref: '#/components/responses/ValidationError' }
        
  /admin/projects/{project}:
    get:
      tags: [Проекты (Админка)]
      summary: Получение информации о проекте
      operationId: getAdminProject
      security: [{ bearerAuth: [] }]
      parameters:
        - name: project
          in: path
          required: true
          description: ID проекта
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Проекты (Админка)]
      summary: Обновление информации о проекте
      operationId: updateAdminProject
      security: [{ bearerAuth: [] }]
      parameters:
        - name: project
          in: path
          required: true
          description: ID проекта
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProjectRequest'
      responses:
        '200':
          description: Проект успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Проекты (Админка)]
      summary: Удаление проекта
      operationId: deleteAdminProject
      security: [{ bearerAuth: [] }]
      parameters:
        - name: project
          in: path
          required: true
          description: ID проекта
          schema: { type: integer }
      responses:
        '204':
          description: Проект успешно удален (No Content)
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Материалы --- 
  /admin/materials:
    get:
      tags: [Материалы (Админка)]
      summary: Список материалов организации
      operationId: getAdminMaterials
      security: [{ bearerAuth: [] }]
      parameters: [] # Добавить пагинацию/фильтры
      responses:
        '200':
          description: Успешный ответ со списком материалов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
    post:
      tags: [Материалы (Админка)]
      summary: Создание нового материала
      operationId: createAdminMaterial
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreMaterialRequest'
      responses:
        '201':
          description: Материал успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        
  /admin/materials/{material}:
    get:
      tags: [Материалы (Админка)]
      summary: Получение информации о материале
      operationId: getAdminMaterial
      security: [{ bearerAuth: [] }]
      parameters:
        - name: material
          in: path
          required: true
          description: ID материала
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Материалы (Админка)]
      summary: Обновление информации о материале
      operationId: updateAdminMaterial
      security: [{ bearerAuth: [] }]
      parameters:
        - name: material
          in: path
          required: true
          description: ID материала
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMaterialRequest'
      responses:
        '200':
          description: Материал успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Материалы (Админка)]
      summary: Удаление материала
      operationId: deleteAdminMaterial
      security: [{ bearerAuth: [] }]
      parameters:
        - name: material
          in: path
          required: true
          description: ID материала
          schema: { type: integer }
      responses:
        '204':
          description: Материал успешно удален
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Виды Работ --- 
  /admin/work-types:
    get:
      tags: [Виды Работ (Админка)]
      summary: Список видов работ организации
      operationId: getAdminWorkTypes
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ со списком видов работ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkTypeListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
    post:
      tags: [Виды Работ (Админка)]
      summary: Создание нового вида работ
      operationId: createAdminWorkType
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreWorkTypeRequest'
      responses:
        '201':
          description: Вид работ успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkTypeResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        
  /admin/work-types/{work_type}:
    get:
      tags: [Виды Работ (Админка)]
      summary: Получение информации о виде работ
      operationId: getAdminWorkType
      security: [{ bearerAuth: [] }]
      parameters:
        - name: work_type
          in: path
          required: true
          description: ID вида работ
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkTypeResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Виды Работ (Админка)]
      summary: Обновление информации о виде работ
      operationId: updateAdminWorkType
      security: [{ bearerAuth: [] }]
      parameters:
        - name: work_type
          in: path
          required: true
          description: ID вида работ
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkTypeRequest'
      responses:
        '200':
          description: Вид работ успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkTypeResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Виды Работ (Админка)]
      summary: Удаление вида работ
      operationId: deleteAdminWorkType
      security: [{ bearerAuth: [] }]
      parameters:
        - name: work_type
          in: path
          required: true
          description: ID вида работ
          schema: { type: integer }
      responses:
        '204':
          description: Вид работ успешно удален
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Поставщики --- 
  /admin/suppliers:
    get:
      tags: [Поставщики (Админка)]
      summary: Список поставщиков организации
      operationId: getAdminSuppliers
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ со списком поставщиков
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupplierListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
    post:
      tags: [Поставщики (Админка)]
      summary: Создание нового поставщика
      operationId: createAdminSupplier
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreSupplierRequest'
      responses:
        '201':
          description: Поставщик успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupplierResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        
  /admin/suppliers/{supplier}:
    get:
      tags: [Поставщики (Админка)]
      summary: Получение информации о поставщике
      operationId: getAdminSupplier
      security: [{ bearerAuth: [] }]
      parameters:
        - name: supplier
          in: path
          required: true
          description: ID поставщика
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupplierResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Поставщики (Админка)]
      summary: Обновление информации о поставщике
      operationId: updateAdminSupplier
      security: [{ bearerAuth: [] }]
      parameters:
        - name: supplier
          in: path
          required: true
          description: ID поставщика
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSupplierRequest'
      responses:
        '200':
          description: Поставщик успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupplierResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Поставщики (Админка)]
      summary: Удаление поставщика
      operationId: deleteAdminSupplier
      security: [{ bearerAuth: [] }]
      parameters:
        - name: supplier
          in: path
          required: true
          description: ID поставщика
          schema: { type: integer }
      responses:
        '204':
          description: Поставщик успешно удален
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Управление Прорабами --- 
  /admin/users:
    get:
      tags: [Управление Прорабами (Админка)]
      summary: Список прорабов организации
      operationId: getAdminForemen
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ со списком прорабов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForemanUserListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
    post:
      tags: [Управление Прорабами (Админка)]
      summary: Создание нового прораба
      operationId: createAdminForeman
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreForemanRequest'
      responses:
        '201':
          description: Прораб успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForemanUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '500': { $ref: '#/components/responses/ServerError' } # Ошибка создания (например, роль не найдена)
        
  /admin/users/{user}:
    get:
      tags: [Управление Прорабами (Админка)]
      summary: Получение информации о прорабе
      operationId: getAdminForeman
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user # ID пользователя
          in: path
          required: true
          description: ID прораба
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForemanUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Управление Прорабами (Админка)]
      summary: Обновление информации о прорабе
      operationId: updateAdminForeman
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user # ID пользователя
          in: path
          required: true
          description: ID прораба
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateForemanRequest'
      responses:
        '200':
          description: Прораб успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForemanUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Управление Прорабами (Админка)]
      summary: Удаление прораба
      operationId: deleteAdminForeman
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user # ID пользователя
          in: path
          required: true
          description: ID прораба
          schema: { type: integer }
      responses:
        '204':
          description: Прораб успешно удален
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Новые пути для ЛК (API #1) ---

  /landing/organization:
    get:
      tags: [Организация (ЛК)]
      summary: Получение данных текущей организации
      description: Возвращает информацию о текущей организации авторизованного владельца.
      operationId: getLandingOrganization
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ с данными организации
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Organization' # Используем существующую схему
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Если не владелец
        '404':
          description: Организация не найдена для пользователя
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFound' # Используем общую схему 404
    put:
      tags: [Организация (ЛК)]
      summary: Обновление данных текущей организации
      description: Обновляет информацию о текущей организации авторизованного владельца.
      operationId: updateLandingOrganization
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOrganizationRequest' # Новая схема запроса
      responses:
        '200':
          description: Организация успешно обновлена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Organization updated successfully
                  data:
                    $ref: '#/components/schemas/Organization'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Если не владелец
        '404':
          description: Организация не найдена или обновление не удалось
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFound' # Используем общую схему 404
        '422': { $ref: '#/components/responses/ValidationError' }

  /landing/support:
    post:
      tags: [Поддержка (ЛК)]
      summary: Отправка запроса в поддержку
      description: Создает новый запрос в службу поддержки от авторизованного пользователя.
      operationId: createLandingSupportRequest
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreSupportRequest' # Новая схема запроса
      responses:
        '201':
          description: Запрос успешно отправлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Support request sent successfully
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '500':
           description: Ошибка при создании запроса
           content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError' # Общая ошибка сервера

  /landing/admin-panel-users:
    get:
      tags: [Управление Пользователями Админ-Панели (ЛК)]
      summary: Список пользователей админ-панели
      description: Возвращает список пользователей с ролями админ-панели (напр., 'web_admin', 'accountant') в текущей организации. Доступно владельцам и администраторам организации.
      operationId: getLandingAdminPanelUsers
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Успешный ответ со списком пользователей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminPanelUserListResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }

    post:
      tags: [Управление Пользователями Админ-Панели (ЛК)]
      summary: Создание пользователя админ-панели
      description: Владелец/администратор организации создает нового пользователя с ролью для админ-панели (например, web_admin, accountant).
      operationId: createLandingAdminPanelUser
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreAdminPanelUserRequest'
      responses:
        '201':
          description: Пользователь админ-панели успешно создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessCreationAdminPanelUserResponse'
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '500': { $ref: '#/components/responses/ServerError' }

  /landing/admin-panel-users/{user}:
    get:
      tags: [Управление Пользователями Админ-Панели (ЛК)]
      summary: Получение информации о пользователе админ-панели
      operationId: getLandingAdminPanelUser
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя админ-панели
          schema: { type: integer }
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminPanelUserResponse' # Нужна эта схема ответа
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
    put:
      tags: [Управление Пользователями Админ-Панели (ЛК)]
      summary: Обновление информации о пользователе админ-панели
      operationId: updateLandingAdminPanelUser
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя админ-панели
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAdminPanelUserRequest' # Нужна эта схема запроса
      responses:
        '200':
          description: Пользователь успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminPanelUserResponse' # Возвращаем обновленный ресурс
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' }
        '404': { $ref: '#/components/responses/NotFoundError' }
        '422': { $ref: '#/components/responses/ValidationError' }
    delete:
      tags: [Управление Пользователями Админ-Панели (ЛК)]
      summary: Удаление пользователя админ-панели
      operationId: deleteLandingAdminPanelUser
      security: [{ bearerAuth: [] }]
      parameters:
        - name: user
          in: path
          required: true
          description: ID пользователя админ-панели
          schema: { type: integer }
      responses:
        '204':
          description: Пользователь успешно удален (No Content)
        '401': { $ref: '#/components/responses/UnauthorizedError' }
        '403': { $ref: '#/components/responses/ForbiddenError' } # Не админ/владелец или пытается удалить себя/владельца
        '404': { $ref: '#/components/responses/NotFoundError' }

  # --- Mobile API - Logging ---
  /mobile/logs/material-usage:
    post:
      tags:
        - Логирование (Мобильное)
      summary: Зафиксировать расход материала
      description: Прораб фиксирует расход определенного материала на проекте.
      operationId: storeMobileMaterialUsageLog
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreMaterialUsageLogRequest'
      responses:
        '201':
          description: Запись о расходе материала успешно создана
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialUsageLogResponse'
        '400':
          description: Неверный запрос (например, ошибка в данных, не прошедшая валидацию на уровне бизнес-логики)
          content:
            application/json:
              schema:
      type: object
      properties:
                  message: { type: string }
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          description: Доступ запрещен (пользователь не прораб или не назначен на проект)
          content:
            application/json:
              schema:
      type: object
      properties:
                  message: { type: string, example: "У вас нет доступа к этому проекту." }
        '404':
          description: Ресурс не найден (проект или материал)
          content:
            application/json:
              schema:
      type: object
      properties:
                  message: { type: string, example: "Проект не найден." }
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'

  /mobile/logs/work-completion:
    post:
      tags:
        - Логирование (Мобильное)
      summary: Зафиксировать выполнение работы
      description: Прораб фиксирует факт выполнения определенного вида работ на проекте.
      operationId: storeMobileWorkCompletionLog
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StoreWorkCompletionLogRequest'
  responses:
        '201':
          description: Запись о выполнении работы успешно создана
      content:
        application/json:
          schema:
                $ref: '#/components/schemas/WorkCompletionLogResponse'
        '400':
          description: Неверный запрос
      content:
        application/json:
          schema:
            type: object
            properties:
                  message: { type: string }
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          description: Доступ запрещен
      content:
        application/json:
          schema:
                type: object
                properties:
                  message: { type: string, example: "У вас нет доступа к этому проекту." }
        '404':
          description: Ресурс не найден (проект или вид работы)
      content:
        application/json:
          schema:
                type: object
                properties:
            $ref: '#/components/schemas/ValidationError'
    ServerError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ServerError'

  # --- Схемы для мобильного логирования ---
  MaterialUsageLog:
    description: Запись лога использования материала
    type: object
    properties:
      id: { type: integer, readOnly: true }
      project_id: { type: integer }
      material_id: { type: integer }
      user_id: { type: integer, readOnly: true }
      quantity: { type: number, format: float, example: 10.5 }
            $ref: '#/components/schemas/ServerError' 