# Проект "Прораб-Финанс Мост"

## 1. Резюме Идеи (Executive Summary)

**Проблема:** Существует значительный разрыв между оперативными данными на стройплощадке (у прораба) и требованиями финансового/бухгалтерского учета (например, в СБИС, 1С). Прорабы фиксируют данные (материалы, работы, часы) в неудобных форматах (блокноты, фото, мессенджеры), а бухгалтерия тратит массу времени на расшифровку, перенос данных и исправление ошибок. Это ведет к задержкам в учете, искажению финансовой картины, отсутствию оперативного контроля и потенциальным кассовым разрывам. Существующие ERP-системы (Procore, CMiC) часто слишком сложны и дороги для малого/среднего строительного бизнеса.

**Решение:** "Прораб-Финанс Мост" – это **SaaS-платформа**, состоящая из:
    *   **Лендинга и Личного Кабинета (React):** Лендинг для описания продукта. Личный Кабинет – основной интерфейс для **Владельца Организации**, где он управляет подпиской, настройками своей компании и создает учетные записи для **Администраторов** (сотрудников, которые будут работать в Веб-админке).
    *   **Веб-интерфейса (Админка) (React):** Для **Администраторов** (доступ которым предоставлен Владельцем через Личный Кабинет). Здесь происходит управление проектами, справочниками (материалы, работы, поставщики), создание и управление учетными записями **Прорабов** (пользователей мобильного приложения), а также просмотр и выгрузка отчетов на основе данных от прорабов.
    *   **Ультра-простого мобильного приложения (React Native)** для **Прорабов** для быстрой фиксации первичных данных прямо на объекте (приемка/списание материалов, учет выполненных работ).
    *   **Облачного бэкенда (Laravel 11)** для централизованного хранения, обработки данных и управления доступом.
    *   **API** для взаимодействия всех частей и для будущих прямых интеграций.
npx @redocly/cli build-docs docs/api/openapi.yaml --output docs/api/index.html

**Ценность:** Платформа устраняет двойной ввод, снижает ошибки, ускоряет обмен данными между "полем" и "офисом", повышает прозрачность и оперативность учета для малого и среднего строительного бизнеса, четко разделяя зоны ответственности Владельца, Администратора и Прораба.

## 2. Ключевые Функции (MVP - Minimum Viable Product)

### Мобильное приложение для Прораба (React Native)

*   **Авторизация:** Вход по логину/паролю (учетная запись создается Администратором в Веб-интерфейсе).
*   **Выбор Объекта:** Возможность переключаться между назначенными объектами.
*   **Приемка Материалов:**
    *   Выбор поставщика (из справочника).
    *   Выбор материала (из справочника).
    *   Ввод количества.
    *   Прикрепление фото накладной/материала.
    *   *Запись лога о приемке.*
*   **Списание Материалов:**
    *   Выбор материала из "остатков на объекте" (принятых ранее).
    *   Ввод количества.
    *   Указание, на какой вид работ списано (выбор из справочника).
    *   *Запись лога о списании.*
*   **Фиксация Выполненных Работ:**
    *   Выбор вида работ (из справочника, привязанного к объекту/смете).
    *   Ввод выполненного объема (единицы измерения подтягиваются из справочника).
    *   Прикрепление фото выполненных работ (опционально, но рекомендуется).
    *   *Запись лога о выполнении.*
*   **Офлайн-режим:** Возможность вносить данные без интернета с последующей автоматической синхронизацией при появлении сети.

### Веб-интерфейс для Администратора/Бухгалтера (React)

*   **Авторизация:** Вход по логину/паролю (учетная запись создается Владельцем Организации в Личном Кабинете).
*   **Управление Пользователями (Прорабами):** Добавление/редактирование/блокировка прорабов, назначение ролей (если предполагается несколько ролей для мобильного приложения).
*   **Управление Объектами:** Создание/редактирование объектов, назначение прорабов на объекты.
*   **Управление Справочниками:**
    *   Материалы (название, ед. изм.).
    *   Виды работ (название, ед. изм.).
    *   Поставщики.
    *   (Важно: эти справочники используются в мобильном приложении для выбора).
*   **Просмотр Логов:** Просмотр всех записей, сделанных прорабами (приемки, списания, работы) с фильтрацией по объекту, дате, типу операции.
*   **Формирование Отчетов/Выгрузок:**
    *   **Ключевая функция MVP!** Генерация отчета (например, за период по объекту) в формате CSV или Excel, структура которого максимально удобна для импорта в СБИС/1С (например, отчет по движению материалов, отчет по выполненным работам).

### Личный Кабинет Владельца Организации (React) - *Новый раздел для ясности*

*   **Авторизация:** Вход по логину/паролю (основной пользователь организации).
*   **Управление Организацией:** Редактирование данных компании.
*   **Управление Подпиской:** Выбор тарифа, оплата.
*   **Управление Пользователями (Администраторами):** Создание/редактирование/блокировка учетных записей для сотрудников, которые будут использовать Веб-интерфейс (Админку).
*   **(Возможно) Просмотр общей статистики/лимитов по тарифу.**
*   **(Возможно) Настройки интеграций (в будущем).**
*   **Техподдержка.**

### Бэкенд и API (Laravel 11)

*   **API:** RESTful API для взаимодействия с мобильным и веб-приложением.
*   **База данных:** Хранение пользователей, объектов, справочников, всех логов операций.
*   **Бизнес-логика:** Обработка данных, расчет остатков материалов на объекте (упрощенный), управление правами доступа.
*   **Фоновые задачи (Queues):** Для обработки синхронизации из офлайн-режима.

## 3. Технологический Стек

*   **Бэкенд:** PHP 8.3+, Laravel 11
*   **Мобильное приложение:** React Native (на базе React 18.3.1)
*   **Веб-приложение:** React 18.3.1, TypeScript 5.5, Vite 5.3.1 (или Webpack 5.92.1)
*   **База данных:** PostgreSQL 16.3 (или MySQL 8.4.0)
*   **Веб-сервер:** Nginx 1.26.1
*   **Кеширование/Очереди:** Redis 7.2.5
*   **Хостинг:** Облачная платформа (AWS, DigitalOcean, Yandex Cloud, etc.)
*   **Версионирование:** Git 2.45.2 (GitLab, GitHub, Bitbucket)

## 4. Монетизация

*   **SaaS-подписка:** Ежемесячная или годовая оплата.
*   **Тарифные планы:** Могут зависеть от:
    *   Количества пользователей-прорабов.
    *   Количества активных объектов.
    *   Объема хранимых данных/фото.
*   **Возможен Free Tier:** Ограниченный план (например, 1 прораб, 1 объект) для привлечения пользователей.

## 5. Пошаговый План Реализации MVP (Примерный)

**(Общая оценка: ~4-6 месяцев для команды из 2 человек, один фулстек/бэкенд, один фронтенд/мобильный)**

**Этап 1: Подготовка и Проектирование (2-3 недели)**

1.  **Детализация требований:** Окончательно определить *минимальный* набор функций для MVP.
2.  **Проектирование UI/UX:** Создать простые, интуитивно понятные макеты (wireframes, mockups) для мобильного и веб-интерфейса. **Ключ - простота для прораба!**
3.  **Проектирование БД:** Разработать структуру базы данных.
4.  **Проектирование API:** Определить основные эндпоинты и форматы данных.
5.  **Выбор и настройка инструментов:** Репозиторий Git, таск-трекер, CI/CD (базовый).

**Этап 2: Разработка Бэкенда (4-6 недель)**

1.  **Настройка проекта Laravel:** Установка, базовая конфигурация.
2.  **Реализация Аутентификации:** Регистрация (для админа), логин (для всех).
3.  **Создание Моделей и Миграций:** Users, Projects, Materials, WorkTypes, Suppliers, Logs (Receipts, WriteOffs, WorkDone).
4.  **Реализация API эндпоинтов:** CRUD для пользователей, объектов, справочников; эндпоинты для записи логов из мобильного приложения.
5.  **Реализация прав доступа:** Разграничение возможностей для прораба и администратора.
6.  **Написание базовых тестов (Unit, Feature).**

**Этап 3: Разработка Мобильного Приложения (6-8 недель)**

1.  **Настройка проекта React Native:** Установка, базовая навигация (React Navigation).
2.  **Экраны Аутентификации:** Логин.
3.  **Экран выбора объекта.**
4.  **Реализация основных экранов:** Приемка, Списание, Выполненные работы (формы ввода, выбор из справочников, загрузка фото).
5.  **Интеграция с API:** Получение справочников, отправка логов.
6.  **Реализация Офлайн-хранилища:** Использование AsyncStorage или Realm/WatermelonDB для хранения данных при отсутствии сети.
7.  **Реализация логики Синхронизации:** Отправка накопленных данных на бэкенд при появлении сети.
8.  **Базовое тестирование на эмуляторах/устройствах.**

**Этап 4: Разработка Веб-Интерфейса (5-7 недель)**

1.  **Настройка проекта React:** Установка, роутинг.
2.  **Экраны Аутентификации:** Логин.
3.  **Реализация CRUD интерфейсов:** Управление пользователями, объектами, справочниками.
4.  **Просмотр Логов:** Табличное представление данных с фильтрацией.
5.  **Реализация Выгрузки Отчетов:** Генерация CSV/Excel файлов по запросу пользователя.
6.  **Интеграция с API.**
7.  **Адаптивная верстка (для десктопа).**

**Этап 5: Тестирование, Развертывание и Запуск (3-4 недели)**

1.  **Интеграционное тестирование:** Проверка взаимодействия всех частей системы.
2.  **Нагрузочное тестирование (базовое):** Проверка производительности API.
3.  **Подготовка инфраструктуры:** Настройка сервера, базы данных, веб-сервера на хостинге.
4.  **Развертывание (Deploy):** Бэкенда и веб-приложения.
5.  **Сборка и публикация мобильного приложения:** Внутреннее тестирование (TestFlight, Google Play Internal Testing).
6.  **Beta-тестирование:** Привлечение реальных прорабов и бухгалтеров для получения обратной связи.
7.  **Исправление багов по результатам бета-теста.**
8.  **Публичный запуск MVP.**

**Этап 6: Поддержка и Развитие (Постоянно)**

1.  **Сбор обратной связи:** Анализ использования, общение с пользователями.
2.  **Исправление багов.**
3.  **Планирование и разработка следующих версий:** Добавление новых функций (см. ниже).

## 6. Будущие Улучшения (Post-MVP)

*   **Прямые интеграции с учетными системами:** API-интеграция со СБИС, 1С (самое важное).
*   **Более детальный учет рабочего времени:** Табели, отчеты по часам.
*   **Управление задачами:** Постановка и контроль выполнения задач для прорабов.
*   **Фото-отчеты:** Возможность аннотирования фото, генерация структурированных фото-отчетов.
*   **GPS-трекинг:** Фиксация местоположения при выполнении операций (опционально).
*   **Уведомления (Push & Email):** О новых задачах, о приемке материалов и т.д.
*   **Аналитика и Дашборды:** Визуализация данных по расходу материалов, выполнению работ, срокам.
*   **Интеграция с бюджетированием/сметами:** Сравнение факта с планом.
*   **Управление Заявками:** Более сложная система заявок на материалы/технику с согласованиями.

---

## 7. Рекомендуемые инструменты разработки

### Пакеты для бэкенда

#### Аутентификация и авторизация
- **tymon/jwt-auth** - реализация JWT аутентификации для Laravel *(будет установлен)*
- **spatie/laravel-permission** - управление ролями и разрешениями *(под вопросом, возможно реализация своей системы)*

#### Обработка API
- **league/fractal** или **spatie/laravel-data** - трансформация данных для API ответов
- **darkaonline/l5-swagger** - документация API через Swagger/OpenAPI

#### Работа с файлами
- **intervention/image** - обработка изображений
- **league/flysystem-aws-s3-v3** - интеграция с S3-совместимыми хранилищами

#### Обработка данных и отчеты
- **maatwebsite/excel** - работа с Excel-файлами для экспорта отчетов
- **barryvdh/laravel-dompdf** - генерация PDF-документов

#### Интеграция с платежными системами
- **laravel/cashier** - для Stripe или аналоги для других платежных систем

#### Очереди и задачи
- **predis/predis** - клиент Redis для очередей и кэширования

#### Инструменты разработки
- **barryvdh/laravel-debugbar** - отладочная панель
- **barryvdh/laravel-ide-helper** - генерация подсказок для IDE
- **nunomaduro/larastan** - статический анализатор кода

#### Тестирование
- **pestphp/pest** - современный фреймворк для тестирования
