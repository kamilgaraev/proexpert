# üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Laravel —Å Loki, Prometheus –∏ Grafana

–ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Ubuntu —Å **24/7 —Ä–∞–±–æ—Ç–æ–π**.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Laravel   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ    Loki     ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Grafana   ‚îÇ
‚îÇ (Host:9091) ‚îÇ    ‚îÇ (Docker)    ‚îÇ    ‚îÇ  (Docker)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                                      ‚ñ≤
       ‚ñº                                      ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  Laravel    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Prometheus  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ  Metrics    ‚îÇ    ‚îÇ (Docker)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SystemD    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Health      ‚îÇ
‚îÇ  Service    ‚îÇ    ‚îÇ Monitor     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ 24/7 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 1. **–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã):**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å
sudo ./install-monitoring-service.sh

# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è
sudo ./setup-cron-monitoring.sh

# 3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Laravel –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
curl http://localhost/metrics
```

### 2. **–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
composer install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
chmod +x start-monitoring.sh
./start-monitoring.sh
```

### 3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞:**

–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ Laravel –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ **Nginx/Apache**, –∞ –Ω–µ —á–µ—Ä–µ–∑ `php artisan serve`.

#### **–î–ª—è Nginx –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```nginx
# /etc/nginx/sites-available/your-site
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/prohelper/public;
    
    # ... –æ–±—ã—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Laravel ...
    
    # –≠–Ω–¥–ø–æ–∏–Ω—Ç –º–µ—Ç—Ä–∏–∫
    location /metrics {
        try_files $uri $uri/ /index.php?$query_string;
    }
}
```

#### **–î–ª—è Apache –¥–æ–±–∞–≤—å—Ç–µ –≤ .htaccess –∏–ª–∏ VirtualHost:**
```apache
# –í public/.htaccess —É–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
RewriteRule ^(.*)$ index.php [QSA,L]
```

#### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
curl http://your-domain.com/metrics

# –ò–ª–∏ –µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ
curl http://localhost/metrics
```

## üìã –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–µ–∫–∞

### üîç **Loki (–õ–æ–≥–∏)**
- **–ü–æ—Ä—Ç:** 3100
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ Laravel
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** API –ª–æ–≥–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** ‚úÖ systemd + healthcheck + autoheal

### üìä **Prometheus (–ú–µ—Ç—Ä–∏–∫–∏)**
- **–ü–æ—Ä—Ç:** 9090
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** Laravel –º–µ—Ç—Ä–∏–∫–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Ubuntu
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** ‚úÖ systemd + healthcheck + autoheal

### üìà **Grafana (–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)**
- **–ü–æ—Ä—Ç:** 3000
- **–õ–æ–≥–∏–Ω:** admin / admin123
- **–î–∞—à–±–æ—Ä–¥—ã:** Laravel Application, Ubuntu System
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** ‚úÖ systemd + healthcheck + autoheal

### üñ•Ô∏è **Node Exporter (–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)**
- **–ü–æ—Ä—Ç:** 9100
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–µ—Ç—Ä–∏–∫–∏ Ubuntu —Å–µ—Ä–≤–µ—Ä–∞
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** ‚úÖ systemd + healthcheck + autoheal

### üîÑ **Watchdog (–ê–≤—Ç–æ—Ö–∏–ª)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —É–ø–∞–≤—à–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏:** 5 —Å–µ–∫—É–Ω–¥

## üï∞Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è 24/7

### **SystemD —Å–µ—Ä–≤–∏—Å:**
- ‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ systemd journal
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ systemctl

### **Cron –∑–∞–¥–∞—á–∏:**
- ‚è∞ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è:** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- üóÇÔ∏è **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤:** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00
- üßπ **–û—á–∏—Å—Ç–∫–∞ Docker:** –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ 3:00
- üì¶ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:** –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 4:00
- üíæ **–ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 1:00

### **Health checks:**
- üè• HTTP –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- üìß –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Laravel

### 1. **Middleware –¥–ª—è –º–µ—Ç—Ä–∏–∫**

`PrometheusMiddleware` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –°—Ç–∞—Ç—É—Å—ã –æ—Ç–≤–µ—Ç–æ–≤
- –ú–∞—Ä—à—Ä—É—Ç—ã

### 2. **–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**

- `laravel_http_requests_total` - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- `laravel_http_request_duration_seconds` - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- `laravel_memory_usage_bytes` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- `laravel_database_connections_active` - –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î
- `laravel_exceptions_total` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- `laravel_queue_size` - –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏

### 3. **–≠–Ω–¥–ø–æ–∏–Ω—Ç –º–µ—Ç—Ä–∏–∫**

```
GET /metrics
Content-Type: text/plain; charset=utf-8
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

```
storage/logs/
‚îú‚îÄ‚îÄ api/          # API –ª–æ–≥–∏ (JSON —Ñ–æ—Ä–º–∞—Ç)
‚îú‚îÄ‚îÄ telemetry/    # –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ laravel.log   # –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ Laravel
```

## üî• –ê–ª–µ—Ä—Ç—ã

–ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã –≤ Prometheus:

### **Laravel –∞–ª–µ—Ä—Ç—ã:**
- **HighErrorRate** - –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ > 10%
- **SlowResponseTime** - 95-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å > 2s
- **HighMemoryUsage** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ > 512MB
- **HighDatabaseConnections** - –ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π > 80

### **–°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã:**
- **HighCpuUsage** - CPU > 80%
- **LowMemoryAvailable** - –°–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏ < 10%
- **LowDiskSpace** - –°–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ < 10%
- **ServiceDown** - –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

## üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

### **SystemD –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
systemctl status monitoring

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
systemctl restart monitoring

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
systemctl stop monitoring

# –ó–∞–ø—É—Å–∫
systemctl start monitoring

# –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞
journalctl -u monitoring -f

# –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
systemctl disable monitoring
```

### **Docker –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker logs grafana -f
docker logs prometheus -f
docker logs loki -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker restart grafana

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
```

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∑–¥–æ—Ä–æ–≤—å—è
tail -f /var/log/monitoring-health.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ cron –∑–∞–¥–∞—á
crontab -l

# –°—Ç–∞—Ç—É—Å cron
systemctl status cron

# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
/var/www/prohelper/monitoring-health-check.sh
```

## üêõ Troubleshooting

### **Laravel –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—É—Å–∫ Laravel:
   ```bash
   curl http://localhost:9091/metrics
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ middleware –≤ `app/Http/Kernel.php`

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ª–æ–≥–æ–≤:
   ```bash
   chmod -R 777 storage/logs/
   ```

### **Prometheus –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Laravel —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
   ```bash
   docker exec prometheus wget -qO- http://host.docker.internal:9091/metrics
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `monitoring/prometheus/prometheus.yml`

### **Loki –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –ª–æ–≥–∏**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º:
   ```bash
   ls -la storage/logs/
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Promtail:
   ```bash
   docker logs promtail
   ```

### **Grafana –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Grafana
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Prometheus –∏ Loki –∏–∑ Grafana

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å systemd —Å–µ—Ä–≤–∏—Å–∞:
   ```bash
   systemctl status monitoring
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ systemd:
   ```bash
   journalctl -u monitoring -n 50
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
   ```bash
   ls -la /var/www/prohelper/
   ```

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Telegram**

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ chat_id
3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `monitoring-health-check.sh`:
   ```bash
   ALERT_WEBHOOK_URL="https://api.telegram.org/bot<TOKEN>/sendMessage?chat_id=<CHAT_ID>&text="
   ```

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Slack**

1. –°–æ–∑–¥–∞–π—Ç–µ Slack App –∏ –ø–æ–ª—É—á–∏—Ç–µ webhook URL
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `monitoring-health-check.sh`:
   ```bash
   ALERT_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
   ```

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ë–î**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ mysql_exporter –∏–ª–∏ postgres_exporter
2. –î–æ–±–∞–≤—å—Ç–µ –≤ prometheus.yml
3. –°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ –ë–î

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –º–µ—Ç—Ä–∏–∫**

1. –í–∫–ª—é—á–∏—Ç–µ nginx_stub_status
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ nginx_exporter
3. –î–æ–±–∞–≤—å—Ç–µ –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°–∏—Å—Ç–µ–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
systemctl status monitoring
journalctl -u monitoring -f
systemctl restart monitoring

# Docker —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
docker-compose logs -f
docker-compose restart prometheus
docker stats

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
tail -f /var/log/monitoring-health.log
curl http://localhost:9091/metrics | head -20

# –ë—ç–∫–∞–ø—ã –∏ –æ—á–∏—Å—Ç–∫–∞
tar -czf monitoring-backup.tar.gz monitoring/ docker-compose.yml
docker system prune -f --volumes
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –≤ Grafana
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ –ø–æ—Ä—Ç–∞–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ firewall:
   ```bash
   ufw allow from 10.0.0.0/8 to any port 3000,3100,9090,9100
   ```
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ authentication** –¥–ª—è Grafana
5. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** –æ–±—Ä–∞–∑—ã Docker
6. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞** –∫ —Å–µ—Ä–≤–∏—Å–∞–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º:**

1. **–£–≤–µ–ª–∏—á—å—Ç–µ retention –≤ Prometheus:**
   ```yaml
   # –í docker-compose.yml
   - '--storage.tsdb.retention.time=30d'
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤:**
   ```yaml
   deploy:
     resources:
       limits:
         memory: 1G
         cpus: '0.5'
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–∂–∞—Ç–∏–µ –ª–æ–≥–æ–≤:**
   ```yaml
   # –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Loki
   chunk_store_config:
     chunk_cache_config:
       enable_fifocache: true
   ```

## üéØ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–°—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∞–º —Å–µ–±—è –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç:

- ‚úÖ **Health checks** –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ **–ê–≤—Ç–æ—Ö–∏–ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥  
- ‚úÖ **–°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ **–ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ —Å–±–æ—è—Ö** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
- ‚úÖ **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 